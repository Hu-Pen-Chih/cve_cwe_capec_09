The present document studies the security when a PLMN hosts an NPN with dedicated NFs deployed in the customer domain.
Figure 4-1 and Figure 4-2 demonstrate two example PNI-NPNs with dedicated NFs deployed in the the customer premises.
The attacker - A compromised NF in the customer premises 5GS Note: The mitigation of DoS by compromised NF in 5GS is left for implementation.
The solution addressing KI#3 needs the capability to comply with local regulation and the related LI identification requirements defined inclause 6.2.
Potential security requirementsEditor’s Note: This clause contains the proposed solutions addressing the identified key issues.
Based on the local policy provided by the operator, the appropriate topology hiding mechanisms can be performed based on the security requirements.
The Security Gateway supports the rate-limiting functionalities to defend itself and subsequent NFs against excessive CP signalling.
The solution presents a Customer InterWoking Function henceforth referred to as CIWF.
When the NPN trusts the PLMN and the PLMN does not trust the NPN, the CIWF is deployed only in the PLMN operational domain.
When the NPN does not trust the PLMN and the PLMN trusts the NPN, the CIWF is deployed only in the PNI-NPN operational domain.
Figure 7.2-1 illustrates CIWF deployed only in PLMN operational domain when dedicated UPF is deployed in PNI-NPN operational domain.
CIWF checks if it is malformed message or wrong type message.
If no, CIWF does topology hiding to SMF’s address and forwards the message.4.
The CIWF-PLMN does malformed and wrong type message blocking for messages sending to the PLMN.
The CIWF-NPN does malformed and wrong type message blocking for messages sending to the PNI-NPN.1.
CIWF-NPN checks if it is malformed message or wrong type message.
CIWF checks if it is malformed message or wrong type message.
"Security for dedicated UPF interacting with PLMN through N4 interface" and KI#2 " Dedicated NFs interacting with PLMN through SBA interface".
Editor’s Note: It is ffs whether the scenario where GMLC is deployed in the customer premises is relevant.
The solution reuses PNI-NPN IDs (e.g. dedicated DNNs, S-NSSAIs) to identify the services sent from the customer premises.
The security proxy forwards the service request to the corresponding NF in the operator premises only after successful verification.
The solution addresses the requirement of KI#2 related to restrict access to services and information exchanged between customer and operator premises.
The procedure proposes to use a PNI-NPN ID to bind the authorized UE range for each hosted NPN.
The NFs in the PNI-NPN Customer’s network trust the Security Gateway deployed in the PLMN.
The Security Gateway handles topology hiding by limiting the PLMN network topology information visible to the dedicated network in customer premises and vice versa.
The Security Gateway supports the rate-limiting functionalities to defend itself and subsequent NFs against excessive CP signalling.
The CIWF deployed in the PLMN operational domain is named as CIWF-PLMN.
Mutual authentication between NFs in the PNI-NPN operational domain and CIWF can be provided by TLS.
Mutual authentication between NFs in the PLMN operational domain and CIWF can also be provided by TLS.
There is no mutual authentication between NFs in the PNI-NPN operational domain and NFs in the PLMN operational domain.1.
CIWF checks if the message is malformed or wrong type message.
If yes, CIWF drops the message.1. SMF1 in the PNI-NPN operational domain sends Nnrf_NFDiscovery_Request to CIWF.3.
NRF sends the access token to the CIWF in Nnrf_AccessToken_Get_ Response.9.
The service request includes the access token received in Step 8.11.
CIWF checks if the message is malformed, or wrong type message, or contains information in the restriction list of information.
The CIWF-PLMN does malformed and wrong type message blocking for messages sending to the PLMN.
CIWF-NPN checks messages sending to the PNI-NPN according to the restriction list of services/operations.
CIWF-NPN checks messages sending from the PNI-NPN according to the restriction list of information.1.
The CIWF-PLMN checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
CIWF-PLMN checks if the message contains information in the restriction list of information.
If no, CIWF-PLMN does topology hiding to modify the address information of NF service provider in the Nnrf_NFDiscovery_Response.
The CIWF-PLMN checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
CIWF-PLMN checks if the message contains information in the restriction list of information.
If no, CIWF-PLMN does topology hiding to NRF’s address and forwards the message to CIWF-NPN.13. SMF1 sends Npcf_SMPolicyControl_Create_Request to CIWF-NPN.
The service request includes the access token received in Step 12.15.
The CIWF-PLMN checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
The CIWF-NPN checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
CIWF does topology hiding for Callback URI in the payload of the messages, IP address or FQDN of the messages etc.
The CIWF does malformed and wrong type message blocking for messages sending to the PNI-NPN.Figure 7.6-6 illustrates an example of the procedure.
Figure 7.6-6 Example of procedure for CIWF deployed only in the PNI-NPN operational domain2.
The CIWF checks if the message contains information in the restriction list of information.
If no, CIWF does topology hiding to SMF1’s address and forwards the message to the CIWF.4.
The CIWF checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
The CIWF checks if the message contains information in the restriction list of information.
If no, CIWF does topology hiding to SMF1’s address and forwards Nnrf_AccessToken_Get_Request to NRF.8.
CIWF checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
CIWF checks if the message contains information in the restriction list of information.
If no, CIWF does topology hiding to SMF1’s address and forwards Npcf_SMPolicyControl_Create_Request to PCF.12.
The solution presents a Customer InterWoking Function henceforth referred to as CIWF.
The CIWF deployed in the PLMN operational domain is named as CIWF-PLMN.
Mutual authentication between NFs in the PNI-NPN operational domain and CIWF can be provided by TLS.
Mutual authentication between NFs in the PLMN operational domain and CIWF can also be provided by TLS.
Client credentials assertion (CCA) based authentication is optionally used between NFs in the PNI-NPN operational domain and NFs in the PLMN operational domain.1.
CIWF checks if the message is malformed or wrong type message.
If yes, CIWF drops the message.1. SMF1 in the PNI-NPN operational domain sends Npcf_SMPolicyControl_Create_Request to CIWF.
CIWF checks if the message is malformed, or wrong type message, or contains information in the restriction list of information.
CIWF-NPN requests access tokens on behalf of NF service consumers in the PNI-NPN operational domain.
The CIWF-PLMN does malformed and wrong type message blocking for messages sending to the PLMN.
CIWF-NPN checks messages sending to the PNI-NPN according to the restriction list of services/operations.
CIWF-NPN checks messages sending from the PNI-NPN according to the restriction list of information.1.
CIWF-PLMN checks if the message contains information in the restriction list of information.
If no, CIWF-PLMN does topology hiding to NRF’s address and forwards the message to CIWF-NPN.9.
The CIWF-PLMN checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
The CIWF-NPN checks if the message is malformed, or wrong type message, or in the restriction list of services/operations.
CIWF requests access tokens on behalf of NF service consumers in the PNI-NPN operational domain.
CIWF does topology hiding for Callback URI in the payload of the messages, IP address or FQDN of the messages etc.
The CIWF does malformed and wrong type message blocking for messages sending to the PNI-NPN.Figure 7.7-6 illustrates an example of the procedure.
Figure 7.7-6 Example of procedure for CIWF deployed only in the PNI-NPN operational domain2.
The CIWF checks if the message contains information in the restriction list of information.
CIWF sends Npcf_SMPolicyControl_Create_Request to the PCF in the PLMN operational domain.
The service request includes an access token received in Step 5, and 8.
Figure 7.8-1: NF Service Consumer obtaining access token before NF Service access2.
The NRF The NRF do the authorization based on the NF profile of NF service producer.
If the NPN information in the token is identical to the one related to the UE, the verifications Otherwise, the verification fails.
The certificate pre configuration or certificate management for PNI-NPN is not in the scope of the solution.
If the NPN information in the token is identical to the one related to the UE, the verifications Otherwise, the verification fails.
This creates a need to prevent unauthorized entities in either network from querying the associated DNS servers.
NFs deployed in the customer premises are configured with a DNS security configuration.
If domain A represents PLMN hosting NPN domain, domain B indicates PLMN domain.1.
A sends Nnrf_NFDiscovery_Request to SCP-A (i.e. the SCP deployed in domain A).
If allowed, the NRF sends the required parameters (e.g., FQDN, IP address of the NF service provider) to the SCP-B via Nnrf_NFDiscovery_Response message.
The SCP-B does the topology hiding for the address information of NF service producer (e.g., FQDN, IP address of the NF service provider).
SCP-A sends the modified NF service producer address information to the NF service consumer.
To do the subscription, the request includes its own address information (e.g., FQDN, IP address).10.
The response message sent by the NF service producer is sent to the SCP-B. The NF service producer 11.
The SCP deployed at the NPN/PLMN in this solution only provides IP and FQDN level topology hiding.
IntroductionThe solution uses the Primary authentication procedure described inClause 6.1 as the baseline with the following adaptations as shown in Figure 7.11-1.
Figure 7.11-1: GPSI usage for UE context management in hosted NPN which is external to Operator’s Security Domain3.
The UDM provides GPSI additionally along with SUPI usage restriction indication to the AUSF in authentication response.4.
The AUSF and UE exchange selected method specific authentication message based on.6.
The secure boot process includes checks of the integrity of the SeE performed by the root of trust.
It’s left for implementation how the SUPI is exchanged from the PLMN to the NPN SeE without disclosure.
Figure 7.13-1: ArchitectureTo support message inspection besides message filtering the SEG needs to be extended to be N4 message content aware.
The SCP discovers the UDM and includes the CCA in the request.5.
The SCP applies topology hiding by substituting the callbacks provided by the AMF with callbacks local to the SCP.
The SCP stores the mapping between the local callback and AMF callback.10-13.
The UDM response a PLMNNPN UE ID, and UDM decide whether the AMF can use SUPI based on the AMF ID.
Otherwise, the UDM sends a SUPI usage indication to AMF to indicate the AMF to remove SUPI.
The AMF will use PLMNNPN UE ID instead of SUPI for further UE context and subscription data management.
Based on the PLMNNPN service indication, the AMF/SEAF in the operator premises knows the AMF/SEAF in the customer premises wants to trigger the primary authentication.
The AMF/SEAF in the operator premises sends a Nausf_UEAuthentication_Authenticate Request message with RES* to AUSF.11.
The message at least includes one of the followings: Result, PLMNNPN UE ID, Kamf, Result, etc.13.
The UDM decide whether the AMF can use SUPI based on the AMF ID.
The UE sends the Registration Request NAS message to the AMF/SEAF in the serving network, containing either a SUCI or 5G-GUTI.5.
Upon reception of the Nudm_UEAuthentication_Get Request, the UDM invokes SIDF if a SUCI is received.
The UDM provides the authentication vectors, SUPI and other necessary parameters to the AUSF in Nudm_UEAuthentication_Get Response message.
The procedure follows as specified in 6.1.3 ofexcept that the AUSF derives KAMF additionally.
The derivation of KAMF includes KSEAF as the root key with inputs as: SUPI, SN ID, ABBA parameter Nausf_UEAuthentication_Authenticate Request message.14.
The AMF/SEAF sends N1 message to the UE with the success indication.
The SUPItemp is used further as UE’s subscriber identifier as long as the UE is served by the AMF in the same customer premises.