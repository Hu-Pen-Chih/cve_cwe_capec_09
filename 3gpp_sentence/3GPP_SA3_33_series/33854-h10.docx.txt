The authorization decision for pairing a UAV and a UAVC is always done by the USS/UTM.
It has been introduced as part of the Reference Architecture in TR 23.754 , as illustrated in the figure below.
Externally, e.g. false location information derived from spoofed GNSS transmitter, spoofed neighbour Cell IDs is reported to the USS/UTM.
Internally, e.g. a compromised UAV reports forged Location Information regardless of received e.g. GNSS signals or neighbour Cell IDs.
overviewThe call flow of this solution is shown in the figure below.
Figure 6.1.2.1-1: UAA procedureNOTE 1: A new IE or an extension of an existing IE can be used to indicate UAA is requested.
The IE can be defined in stage 3 and in coordination with CT.
AMF returns a Registration Accept message to the UAV and indicates that UAA is pending.d.
The message AMF sent to UE includes the UAS-ID and 1.
The USS/UTM sends the UAA revocation request to AMF through UFES to revoke the UAS service for a UAV.
The UAV is identified by the GPSI and UAS-ID in the UAA revocation Request.
The AMF This solution addresses the key issue #1 (the fourth requirement for the fake USS/UTM has not been addressed).
The UAS authentication and authorization (UAA) with USS/UTM is performed after UAV is authenticated with the network (using UE ID).
This solution supports multiple UAA methods to meet potential different authentication requirements from USS/UTM.
Also, the UEs are provisioned with a CAA level ID and corresponding credentials to be used in UAS authentication and authorization (UAA) by USS/UTM.
The connection is allowed only between UAV/UAVC and UAS AF.NOTE 2: UAV/UAVC These type of PDU session request are out of this solution's scope.
The UAS AF gets the relevant subscription information from PCF or UDM with support from existing BSF functionality via SBA interfaces.
An authentication and authorization procedure is executed between UAV/UAVC and USS/UTM.
UAS AF relays the messages in this A&A procedure providing API's, which use well-known web security mechanisms such as HTTPS, for the UAV-application and USS/UTM.
USS/UTM considers the combined information from the UAV/UAVC and from the mobile network operator of the UAV/UAVC while performing the procedure.
Note that if the information sent to the USS/UTM before this step is enough for the authentication & authorization procedure, there 7.
The certificate of the UAS-AF needs to be provisioned to the PGW.
The PGW terminates TLS for HTTPS-requests towards to the UAS-AF and then apply header-enrichment.5.
UTM/USS performs authentication and authorization steps which are transparent to the network.
In this communication, the UAS AF and PGW relay the traffic between UAV and UTM/USS.7.
UAS AF provides related information needed by the USS/UTM to call that API, during the authentication and authorization procedure.
During the authentication and authorization procedure, UAS AF provides the UE-IP of the UAV to the USS/UTM.
An API-based authentication procedure is triggered by AMF following a Registration procedure based on the UE subscription and capabilities information.
The procedure for authentication and authorization (A&A) by the USS/UTM is performed using non-g. CAA-level UAV ID, certificate).
The AMF forwards transparently the authentication messages between the UAV and the USS/UTM.
The solution proposes an A&A Proxy function to be used for A&A communication with USS/UTM.
This A&A Proxy function 6.3.2.1 UAV authentication and authorization by USS/UTM1.
The UE sends a Registration Request message including its UE id, a UAV id and UAV communications capabilities.
If the UE is not already authenticated by the network, a primary authentication procedure is performed.
UE is authenticated using UAV credentials (e.g. CAA-level UAV ID, certificate).
During the procedure, the AMF provides the USS/UTM with a g. GPSI as External id) and AMF a temporary Session id) from USS/UTM.
The AMF stores the CAA-level UAV id in the UE context.
The AMF The AMF provides the CAA-level UAV id and to the UE in the following step.6.
Upon successful UAV A&A by USS/UTM, AMF initiates the UE Configuration Update procedure to deliver authorized UAS Configuration parameters to the UE.
The UAS Configuration The CAA-level UAV ID is used for remote or broadcast Remote ID.8.
The UE receives a PDU Session Establishment Accept message authorizing UAS communications.
NOTE 3: PDU Session establishment and UAS communications steps above Additional details for pairing authorization are assumed to be covered in solutions for KI#2.
The USS/UTM sends an Authorization revocation request to the A&A Proxy providing the4.
The AMF checks if there are any active PDU session used for UAS communications (used with USS/UTM and/or UAV-C).6.
The revocation request is received by the UAS NF which notifies the AMF.
AMF API based procedure introduces a new mechanism compared to existing EAP framework.
The USS/UTM The procedure for UAV A&A by USS/UTM based on PDU secondary authentication is depicted in Figure 6.4.2.1-1.
The same procedure Figure 6.4.2.1-1: Procedure for UAV authentication and authorization with USS/UTM PDU Session establishment 0.
The UE has successfully completed a primary authentication and is registered with the network.
The UE provides the CAA-level UAV ID obtained from successful authorization by USS/UTM.
The UE receives a PDU Session Establishment Accept message authorizing UAS communications.
Pre-condition: UAV has been previously authorized by USS/UTM according to procedure 6.4.2.1.
This solution enables a secondary authentication with a USS/UTM reusing the high-level procedure defined for the PDU secondary authentication by an external DN-AAA.
This Proxy A&A function The authentication and authorization (A&A) by the USS/UTM procedure is performed using non-g. CAA-level UAV ID, certificate).
For simplicity, only the non-roaming case is represented in this solution.
The UE has successfully completed a primary authentication and is registered with the network.
The UE exchanges UAS traffic with peer UAV-C. The UAV and UAV-C Pre-condition: UAV has been previously authorized by USS/UTM according to procedure 6.5.2.1.2.
The USS/UTM sends an Authorization revocation request to the A&A Proxy providing the4.
The SMF initiates a PDU session release procedure for the applicable PDU sessions.8.
The UE provides its CAA-level UAV ID in the PDU Session establishment request to indicate it wants to access UAS services.
The SMF triggers UUAA via a Proxy A&A (UAS NF), if the UE has a valid Aerial subscription.
The transport of the security information is enabled during a PDU Session establishment procedure (with UUAA).
The solution enables the transport of security information (token, key material) from the USS/UTM to the UE to secure C2 communications with UAV-C or USS/UTM.
The transport of the security information is enabled during a PDU Session establishment/modification procedure (with UUAA and/or pairing authorization).
solution proposes to use the currently supported location service to provide network-based location information to the USS/UTM.
The USS/UTM sends the location request to UFES to request the UAV location from network.
The details of providing such an authorization are left to implementation/deployments.
The same mechanism can be applied to a networked UAV Controller when required.
The UAV sends registration request to AMF and a primary authentication is performed as specified in TS 33.501.
AMF sends to UE (UAV) an UAS authentication Required Indicator or a pending UAA indication in the Registration Accept message.
Based on the USS routing Information, the AMF sends a UAS Authentication request message (i.e., over a service-based interface) to the UFES.
The routing to a UFES and USS/UTM and external ID usage need to be aligned with SA2 agreements during the normative work.
The UFES forwards the received UAS authentication request message to the appropriate USS/UTM.
The USS/UTM performs authentication method specific message exchange with the UAV to enable mutual authentication.
In response to the successful UAS authentication, the USS/UTM sends the UAS authentication response message to the UFES.
The UAV uses the UAS root security context identifier to uniquely identify the UAS root security context.
The UAS root security context can be used by the UAV and USS/UTM to set up secure connection.
The UFES sends the received UAA Revocation Notification message to the AMF with the CAA level UAV ID.Step 6.
The AMF further sends an UAA Revocation acknowledgement message with Success Indication, GPSI and CAA Level UAV ID to the UFES.Step 10.
The MME, based on the subscription information, selects the Default APN for connectivity with the USS/UTM based on 23.754 .
The MME receives a create session response form SMG+PGW-C and an attach accept is provided to the UAV.Step 7.
In response to the successful UAS authentication, the USS/UTM sends the UAS authentication response message to the UFES.
The UAS authentication response message includes an authentication result with Success Indication,Step 10.
The UFES sends the received UAA Revocation Notification message to the SMF+PGW-C (the serving PGW can be identified based on TR 23.754 ).
The MME sends the received UAA Revocation acknowledgement and CAA Level UAV ID, to SMF+PGW-C, which can delete the locally stored UAV information.
The SMF+PGW-C send the UAA Revocation acknowledgement along with the CAA Level UAV ID to the UFES.Step 9.
Optionally UAVC ID if received), which can enable subsequent UAS service authorization and security set up.
USS/UTM requests the location service to 5GS with a requirement of high reliability.
If the network-assisted positioning method as defined in clause 6.11.2 inis chosen, the location result will not depend on the UE's report.
USS/UTM The solution reuses the existing location service provided by 5GS.
The Network Assisted Positioning method can be regarded as trusted as it does not rely on the UE's report.
Based on the result of the verification, USS/UTM This solution addresses the key issue #1 UAS Authentication and Authorization.
After successful authentication, the AUSF provides in its authentication response this UAV type information to AMF (step 2).
By this, the AMF knows that the UE is a UAV type UE that also wants to connect to USS/UTM system.
whether a communication between UAV and UTM is needed in steps 8 and 9.
it is assumed in these flow that the authentication and authorization will happen.
The UAV sends a Registration Request to the AMF requesting to register as UAV.
The UE includes USS/UTM routing information in the Registration Request message.3.
The AMF sends the Registration Accept message to the UAV indicating that the UAV needs to be authorized by the USS/UTM.
NOTE 3: At this point the UAV has restricted access to PDU sessions.
The USS/UTM sends an Authorization Revoke request to the UFES including the4.
Whether all connections or only connections dedicated to the UAS service are released is left for the normative phase.6.
The UFES confirms to the USS/UTM that the revocation has happened.
This solution addresses the key issue #2: Pairing authorization for UAV and UAVC.
This solution assumes UAV and UAVC are equipped with SUPI and credentials from PLMN.
Provisioning: a. UAV and UAVC: provisioned with UAV IDs and corresponding credentials, e.g. their private/public key pairs and certificates issued by UAS service providers/operators.
NOTE 1: UAV and UAVC pairing are not be determined by other parties than USS/UTM or UAS itself, e.g. between UAV and UAVC.
Primary Authentication: UE1 (UAV) and UE2 (UAVC) are equipped with SUPI and2.
USS/UTM NOTE 3: UAV (or UAVC) does not send GPSI to AMF.
Instead, it sends UE ID (e.g. GUTI or SUCI) as a normal UE and AMF will convert the UE ID into GPSI.
UAV sends a pairing request message, e.g. in a PDU Establishment Request message to USS through the network (e.g. AMF or SMF and UFES).
The message will include UAV-ID and its UE ID (e.g. GUTI).
For Case 2, it includes UAV-ID (and UE ID if available) of the paired UAVC as well.
The USS/UTM sends the UAA revocation request to SMF through UFES to revoke the UAVC pairing for a UAV.
The UAV and UAVC are identified by their GPSI and UAS-ID respectively in the UAA revocation Request.
The SMF 6.12.1 Solution overview- KI#5 " Privacy protection of UAS identities ".
The fake USS/UTM issue part of KI#1 is also addressed in this solution.
This feature allows a given USS/UTM to obtain a list of UAVs that are present in a specified target area.
The procedure in clause 6.13.2.2 are used to authenticate and authorize a UAV.The steps are as follows:2.
The MME sends a Create Session Request message to the SMF+PGW-C.
The SMF+PGW-C requests a UAV authentication and authorization from the UFES and includes the Aviation Connectivity payload in the request.10a. and 10b.
The UFES further informs the SMF+PGW-C that the UAV has been successfully authenticated and authorized by the USS/UTM.
The UFES passes the received authorization information onto the SMF+PGW-C. The SMF+PGW-C stores the network authorization information as part of the UE context.
The network part of the authorization data contains authorization information applicable to existing PDN connections, which influence SMF+PGW-C decisions for the traffic on these connections.
The MME passes the UAV authorization information to the UAV to inform the UAV that the authorization was successful.
The UAV authorization information contains any needed aviation information, e.g. a new CAA-level UAV ID.
The flows assume that the UAV has already connected to 5GS and been authorized to act as a UAV (see for example solution #6.8).
Figure 6.14.2.2-1: Authentication and authorization of a connection between a UAV and UAVC1.
The UAV sends a PDU Session Establishment Request to the SMF with an indication that the PDU session is for UAV operation.
The UAV also include the Aviation Connectivity payload which contains the allocated CAA-Level UAV ID and flight/pairing information.4.
The USS/UTM includes authorization information for both the network and the UAV.8.
The SMF triggers a PDU Session Establishment Accept message to the UE.
Before proceeding with the revocation, the UFES checks that the USS/UTM was the one that authorized the UAV.4.
The SMF removes the connectivity of the UAV based on the received details (e.g. prevents the UAV from communicating with the UAV-C).
The UFES confirms to the USS/UTM that the revocation of connectivity has happened.
UAV operation Request procedure can be based on agreements from SA2 23.754 .
The UAV sends to the AMF, a PDU Session establishment Request with Pairing Authorization Request Information.
Optionally Step 7-10 can be skipped and only step 10 is performed if the UAV-C is connected to the USS/UTM over internet.9.
If the received authorization information match with the locally stored information, the USS/UTM considers the UAV-C pairing authorization as successful.11.
Further the USS/UTM sends a Pairing Authorization Response/Accept message to the UFES in response to receiving step 5.
The Pairing Authorization Response contains Pairing Success indication, UAV ID, UAV-C ID, UAS ID, Session Security Information, GPSI, and UAV-C IP address.13.
The SMF locally stores the information received in the Pairing Authorization Response as part of pairing authorization status information.
Further performs N4 session set up for the authorized pair of UAV and UAV-C. 14.
Pairing Authorization Revocation: Figure 6.15.2-2: UAV and UAV-C pairing authorization revocation1.
NOTE 2: SA2 defines the content of UAV and UAVC pairing information, e.g.4.
The message name used in EPS procedure can be aligned with SA2 where required during the normative work.
The UAV and UAV-C pairing authorization when connected to EPS is described as follows.2.
If both the received Pairing authorization request information and locally stored information matches, the MME considers the check as successful and perform step 3.
Further the USS/UTM sends a Pairing Authorization Response/Accept message to the UFES in response to receiving step 5.
The Pairing Authorization Response contains Pairing Success indication, UAV ID, UAV-C ID, UAS ID, Session Security Information,13.
The SMF+PGW-C locally stores the information received in the Pairing Authorization Response as part of pairing authorization status information.
Further performs N4 session set up for the authorized pair of UAV and UAV-C. 14.
The UAV sends in response, a pairing revocation acknowledgement and CAA level UAV ID to the MME.
The UAV updates the pairing information based on the received new authorization data and sends an acknowledgement back to MME.
Solution overviewAccording to the conclusion in TR 23.754 , the UTM/USS shows the e. GPSI) to invoke MNO services and to revoke authentication & authorization.
To obtain UAV location information, the UAS NF uses location services (LCS) as supported by AMF/MME or GMLC.
The Network-Assisted Positioning Procedure between the LMF and NG-RAN is selected for location information veracity.
The UAS NF ensures that the USS/UTM is authorized to track the location of a given UAV before sending the UAV location information to USS/UTM.
Furthermore, a USS/UTM can be authorized to receive the data about all UAVs in a particular geographic area.