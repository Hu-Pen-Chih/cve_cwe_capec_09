Application Context Relocation: End-to-end service continuity procedure described in clause 8.8.Application Server: Application software resident in the cloud performing the server function.
A functional entity resident in the UE providing services for the Application Clients.
From the standardization point of view, these mechanisms need to be standardized to solve interoperability issues.
In the architecture, the H-ECS is associated with HPLMN, while the V-ECS and the EDN which the UE accesses is associated with VPLMN.
A new reference point EDGE-10 is defined between ECSs (i.e. V-ECS and H-ECS).
In the architecture, the H-ECS is associated with HPLMN, while the V-ECS and the EDN which the UE accesses is associated with VPLMN.
A new reference point EDGE-10 is defined between ECSs (i.e. V-ECS and H-ECS).
The new interface is introduced for EES discovery in roaming PLMN in solution 5 or V-ECS information retrieval in solution 14.
This key issues studies the related transport security, i.e. confidentiality, integrity, and replay-protection.
EDGE-5 reference point supports AC registration, EAS discovery, ACR request, AC subscription, and AC notification.
Such mobility transitions result in replacing the source the EES (S-EES) with a target EES (T-EES).
Replacing the S-EES with the T-EES requires a procedure named Application Context Relocation (ACR).Therefore, it is proposed to study authenticate and authorization between two EESes.
if the EAS or EEC does not have it (e.g. has not already cached).
UE obtains B-TID from BSF in the home network during the GBA procedure.
Upon receiving the provisioning request, ECS detects the home network of the UE based on the B-TID according to 3 .
According to subclause 6.1.3.18 of 3 , AF can obtain UE information from PCF using the event report procedure.
And ECS can verify if UE is roaming by comparing the home network identifier with the PLMN identifier that is sent by PCF.
If EEC is not hosted in the roaming UE, the non-roaming authentication and authorization mechanism among EEC and ECS can be employed.
Zn-Proxy sends the authentication request to the BSF in the home network of the UE.
Zn-Proxy sends the KECS and KECS expiration time to the ECS.Step 8.
Upon receiving the KECS, ECS derives the KEEC-ECS based on the KECS and EEC ID.
ECS generates token for the EEC after the EEC is authenticated and TLS connection is established.
UE obtains B-TID from BSF in the home network during the GBA procedure.
Upon receiving the provisioning request, EES detects the home network of the UE based on the B-TID according to 3 .
According to subclause 6.1.3.18 of 3 , EES can obtain UE information from PCF using the event report procedure.
And EES can verify if UE is roaming by comparing the home network identifier with the PLMN identifier that is sent by PCF.
If EEC is not hosted in the roaming UE, the non-roaming authentication and authorization mechanism among EEC and EES can be employed.
Zn-Proxy sends the authentication request to the BSF in the home network of the UE.
Zn-Proxy sends the KEES and KEES expiration time to the EES.Step 8.
Upon receiving the KEES, EES derives the KEEC-EES based on the KEES and EEC ID.
The EEC authorization is processed based on pre-configured policies or the token provided by the EEC.
For the pre-configured policies based EEC authorization case, EES authorizes the EEC if the EEC registration request message matches the pre-configured policies.
For the token-based EEC authorization case, the EES first checks if the token is expired.
If the token is not expired, EES verifies the ECS digital signature in the token using the public key or certificate of ECS.
If the information is matched, EES authorizes EEC to access the requested service.
The UE determines the authentication method based on the information received in ECS configuration information.
If one authentication method is selected and indicated then the same Step 3.
The initial provisioning request includes the relevant parameter (e.g. A-KID or B-TID or OAuth Token) based on the selected authentication method.
The request from the EES includes the EES profile, EES security credentials and the supported authentication method(s) by the EES.Step 3.
The ECS sends an EES registration response indicating success or failure of the registration operation.
Upon receiving authentication method selection request, ECS/EES choose an authentication method based on the authentication methods that the EEC supports and its pre-configured policies.
ECS/EES sends the selected authentication method to the UE/EEC via the authentication mechanism selection response message.
the UE has already done an edge computing service in the home network, the UE stores the selected TLS authentication method.
According to the received ECS/EES authentication information, UE selects TLS authentication methods supported by both sides.
UE that hosts EEC(s) stores the TLS authentication method used in the home network.
UE sends the EEC Registration Request message as defined in 3 , which includes the list of UE supporting authentication mechanisms.
The potential authentication mechanisms list includes TLS with AKMA, TLS with GBA, TLS with certificate, or other mechanisms if any.
The order in the list indicates the priority of the UE preference.
After sending the response to UE in step 3, network prepares for the authentication procedure according to the chosen authentication mechanism.
Solution overview6.8.2.0 GeneralThe authentication between EEC and ECS is performs thanks to the execution of TLS handshake protocol with authentication method selected by the ECS.
There is a list for authentication mechanism supported by HPLMN, which is ordered according to a priority based on operator's security policy.
In this case, EEC takes the role of UE and ECS takes the role of AF respectively.
This solution based on TLS authentication protocols introduces no impact to network entities and existing procedures.
Thus, the EEC can verify the message had not been tampered with.
Solution overviewThe procedure flow of the solution is depicted in figure 6.13.2-1 and the steps are explained below.
The solution assumes that there is a mechanism in the UE to authenticate the EEC.
KEEC is derived from KAF and EEC-ID as KEEC = KDF(KAF, EEC-ID).
KEEC and E(KAF, EEC-ID) are revealed to the EEC where E(KAF, EEC-ID) is the encryption of EEC-ID under the key KAF.
The network sends KAF, expire time for the key and and optionally GPSI to the ECS/EES.Step 7.
This solution also proposes two alternative methods for validation of the GPSI, by the ECS/EES, which is optionally sent by the EEC to the ECS/EES.
The EEC sends a session establishment request to the ECS/EES, including the parameter A-KID.Step 4.
This solution addresses key issue #2.1 by proposing to re-use existing AKMA mechanism for authentication the UE by the ECS/EES.
It does not have any impact on the existing AKMA mechanism.
This solution addresses security requirement for authentication algorithm selection between EEC and ECS in key issue #2.2.This solution assumes that:- EEC and ECS Step 0.
Supported Authentication method(s) per network (e.g. GBA, AKMA) of PLMN(s) is stored in UDM.Step 2a.
The Authentication mechanism capability indicates the authentication mechanism the ECS support.
When the UE would like to connect with ECS, if the Authentication mechanism capability received, performs step 2b, skip steps 3 to 5.
Then the EEC determines the candidate authentication mechanism (s) based on EEC authentication capability and the available network authentication mechanism.
The UE sends request to ECS with candidate authentication mechanism (s).Step 5.
During the registration procedure, the UDM obtains the supported Authentication method(s) based on the PLMN Id provided by AMF.
The UDM provides to UE via AMF using UCU procedure or registration response.
The Authentication mechanism capability indicates the authentication mechanism the EES support.
When the EEC would like to connect with EES, if the Authentication mechanism capability received, performs step 5, skip steps 6 to 8.
Otherwise, performs steps 6 to 8 and skip step 5.Step 6.
Then the EEC determines the candidate authentication mechanism (s) based on EEC authentication capability and the available network authentication mechanism.
The EEC sends request to EES with candidate authentication mechanism (s).Step 8.
Using of HPLMN identifier is not addressed in the present document.
It is assumed that the ECS/EES is preconfigured with the information indicating which feature (AKMA or GBA) is supported by the HPLMN.
There are two alternatives for this verification: AKMA and AF Specific UE ID Retrieval API.
Since the decision is done by the server itself, there is no need to have a negotiation mechanism for this check.
The server decides on the method considering existence of AKMA usage agreement with the HPLMN.
Solution overviewPre-requisite:The mutual authentication between V-ECS and H-ECS can be done based on the preconfigured credentials.
The H-ECS sends roaming information request message to the NEF.Step 6.
The H-ECS discovers the V-ECS which have suitable EES based on the roaming information.
The solution is based on reusing existing mechanisms and hence has no standard impact.
This solution addresses the requirements of KI#2.6 on the authorization between EESes.
This solution addresses key issue #2.2 by providing a secure way to negotiate the authentication method used between the EEC and ECS/EES using existing procedures.
This solution is not taking a stance on the viability of these solutions.
If the UE and ECS/EES do not support a common method, the TLS handshake will fail.
This contribution proposes a high-level solution for EEC authentication using token-based mechanisms.
For EEC authentication by the ECS/EES, the EEC provides the token to the ECS/EES so that the ECS/EES accepts the request coming from the EEC.
This solution introduces another authentication method option, token-based approach, which is a method widely used in the ecosystem.
The details of the token-based solution are not specified but an example is presented to skect how this method can be used.
ECS processes the request and generates the requested tokens after authorization of EEC.
The AC/EEC sends an Application Context Transfer request to the T-EES and the request included T-EES access authorization tokens and ACT Authorization tokens.
The S-EES transfer the AC application context to the T-EES if the token validation is successful.
The S-EAS make the decision about whether to perform the ACR, and starts the ACR at a proper time.
The EEC received the ACR authorization token from the ECS as the results.1.
Otherwise, if the T-EES is the same as the S-EES, EEC Context Push relocation is skipped.
In the case of S-EES executed ACR, the EEC has subscribed to receive ACR information notifications for target information notification events.
The S-EAS In this step, the S-EAS and S-EES negotiate an address of the Application Context storage to S-EES.2.
The detection entity performs ACR launching procedure with the ACR action indicating ACR determination and the corresponding ACR determination data.
If the EEC or S-EAS detect the ACR event, the EEC or S-EAS Phase III: ACR Execution:5b.
If required, the S-EES performs ACR parameter information procedure by sending the ACR parameter information request to the T-EES.7.
As the results of receiving the notification, the EEC responds to the EES with the authorization token to authorize the ACR.9.
The S-EES This solution addresses the requirements of KI#2.6 on the authorization between EESes.
How to get the target EES's ID in the authorization token is not addressed in the present document.
An EES sends its access token requests to the ECS where it is registered as OAuth 2.0 client.
The ECS authenticates the EES and can verify the input parameters in the access token request.
After successful authentication and verification of the input parameters, the ECS can forward the access token request to another ECS.
Step 1: In the PDU session establishment, the SMF/UPF generates a random ticket value during UE IP address allocation procedure.
Step 5: The EES invokes the Nnef_UEId GET service operation using the ticket value and the IP address.
Step 6: The NEF sends the received ticket value to the BSF (Binding Support Function specified in ) in Nbsf_Management_Discovery service operation.
This solution supports the 5G System to verify the IP address in the request to obtain a UE Identifier.
In the proposed procedure, both the EEC and BSF perform a hash calculation.
Thereafter, the secured communication is established between the EEC and the EES.Step 3.
The NEF uses the Nnrf_NFDiscovery service operation to obtain the address of the UPF implementing NAT functionality for the UE (public) IP address.
The NEF uses the Nupf_GetPrivateUEIP_Get service operation to request UE's (private) IP address from the UPF.
The request includes the UE (public) IP address and Port Number, and optionally IP domain, DNN and S-NSSAI associated with the AF ID.Step 11.
When the NEF invokes the Nbsf_Management_Discovery service operation, the NEF provides the hash value and the nonce to the BSF.Step 13.
If the received hash value and the expected hash value are the same, then the BSF will respond to the NEF with a SUPI.
The EES will send the UE ID to the EEC.This solution is for the key issue 2.7 on EEC provided IP address verification.
If NAT is used, the UPF stores the mapping between private IP address, public IP address, port number.
NEF obtains the private IP address#3 from UPF via existing procedure specified in clause 4.15.10 (from step 3 to step 6) of 502 .Steps 7-8.
NEF obtains AF specific GPSI via existing procedure specified in clause 4.15.10 (from step 7 to step 10) of 502 .This solution is not evaluated.
EES receives the UE's IP address and the verification information from the EAS/UE/EEC.
If A-KID is provided, the NEF gets SUPI of the UE from the AAnF.
If the IP addresses are not identical, the BSF sends the error message to the NEF.
Otherwise, the BSF sends SUPI of the UE to the NEF.Step 8.
If the NEF receives an error message from the BSF, the NEF forwards the error information to the EAS/EES in the response message.
To generate verification information, the IP address and the SUPI are set as the inputs of the KDF.
The output of the KDF is set as the verification information that enables BSF to detect IP address spoofing attack.
EEC/UE sends the UE's IP address and the verification information to the EES directly or via the EAS.
The verification information is generated based on the IP address and the SUPI of the UE.
In specific, the IP address and the SUPI of the UE are set as the input of the KDF.
And the output of the KDF is set as the verification information.
EES includes the received IP Address and PDU Session ID in the request message.
Step 4-5: In Nudm_SDM_Get response the UDM sends the AF specific UE identifier and UE IDs of the received SUPI.
The NEF provides the AF specific UE Identifier and UE IDs to the EES in Nnef_UEId_Get response.
Solution #21 that proposes to use local policy for authorization as described in 3clause 13.3.0 between EESes is endorsed for conclusion.