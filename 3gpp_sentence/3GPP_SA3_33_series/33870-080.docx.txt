In the case of a reference to a3: “Non-Access-Stratum (NAS) protocol for 5G System (5GS)”.
Key issue detailsThe length can become visible to an attacker in case a length preserving encryption scheme is being used for identifier concealment.
In 5G EAP-AKA’, the UE always sends the same SUCI in the EAP layer.
The establishment cause value is sent in the clear over-the-air in RRC Setup Request messages.
Ues assigned access identities 11-15, will send establishment cause “highPriorityAccess”, which affords them admission benefits when accessing the network.
So, similar methods can be reused for the digital identifier configuration).
The solution can work with the mandatory authentication methods such as 5G-AKA, EAP-AKA’ and with the optional EAP methods.
If an attacker can learn something about the length, such knowledge will reduce the size of the anonymity set.
This solution proposes a padding mechanism to protect the privacy of variable length SUPIs in NAI format.
In this solution, the UE pads the username with a random length padding.
The UE performs ECIES-based encryption on the resulting username padded with special characters to generate the ciphertext used to form the final SUCI output 3.
AUSF forwards the SUCI containing SUPI in NAI format to the UDM/SIDF7.
If UDM/SIDF receives a padding method indication with the SUCI, UDM/SIDF unpads SUPI in NAI format based on the padding method indication.
lmin/lmax values are used such as to ensure that resulting cleartext length is according to a normalized range across SUPIs after padding.
To signal the use of pseudonyms, the solution relies on the introduction of new protection scheme identifies.
For example: 0x3 for Profile <C> where Profile C is identical to Profile <A> except that the pseudonym is used instead of the SUPI.
If the included scheme identifier does not signal the use of pseudonym, then the SIDF obtains the SUPI directly after decryption.
A fixed k value (for a desired k-anonymity level) gives two length limits shown as lmin and lmax.
Figure 6.3.2.3-1 Example of SUPI distributionObserve also that the pseudonym value is irrelevant for anonymity.
The solution has impact on the UE and the SIDF, consequently the UDM.
The solution requires the introduction of new protection scheme identifiers to signal the use of pseudonyms.
A fixed k value (for a desired k-anonymity level) gives two length limits shown as lmin and lmax.
The middle parts of distributions between lmin and lmax typically have much higher frequencies and no privacy disclosure issue in length.
Figure 6.4.2 Example of SUPI distributionNOTE: How to analyze and choose lmin and lmax could be left to the implementation.
According to clause 2.2A of TS 23.003, the 5G standard allows the use of Network Specific Identifiers (NSI) as SUPI.
An NSI will take the form of a Network Access Identifier (NAI) as defined in clause 28.7.2 of TS 23.003 .
Username in NAI format is encrypted during SUCI generation for privacy reasons.
Usually, the username part of NAI is created based on real-world names.
Hence any encoding of the realworld names can lead to predictable outcomes which could also be guessed.
This Figure 6.1.5.2-1 illustrates the system level message sequence detailing this solution.
The steps are described as follows:Extension/padding of SUPI NAI is configured by the operator.
The UDM need to be updated to strip/ignore the extension in the NAI username.
Editor’s note: Details about padding, padding parameters provisioning, or use are FFS.
The Nudm_UEAuthentication_Get Request containing SUCI is sent from AUSF to UDM.5.
If SUPI with plaintext is found in the database of the UDM, the UDM selects the authentication method according to the SUPI.
Then, the UDM generates the authentication data including the authentication vector and sends it to AUSF in the Nudm_UEAuthentication_Get Response message with "200 OK".
If SUPI is not found in the database, the UDM returns "404 Not Found" with "USER_NOT_FOUND" in the Nudm_UEAuthentication_Get Response message.7.
The AMF/SEAF sends RAND and AUTN to the UE in the Authentication Request message in the case of "201 Created".
Otherwise, the AMF/SEAF sends the Registration Reject message with Cause#3 to the UE in the case of "404 Not Found".
NOTE 1: SUPI in IMSI format is not truncated because it is fixed length.
The UDM invokes the SIDF to de-conceal the SUCI to the truncated SUPI.
GPSIs (including MSISDN) are used for such purposes, which of course can be based on real-world names of the actual subscribers.
The fixed length that is chosen for the username can be left to the decision of the home network operator.
This solution assumes that the operator has existing process for changing SUPI on the UE and the UDM.This is a solution to KI #1.
NOTE 3: TLS 1.2 is going to be phased out by NIST requirement in early .
Padding of SUPIs in NAI format is performed by the same component, either USIM.
If the number of octets in the unpadded username is not indicated in the list of pLen, the username is not padded.
Padding of SUPIs,which is not concealed in a SUCI and sent over a protected channel,is done by theUE.
The UDM/SIDF removes 0x20 octet from the beginning of the username until a non-0x20 octet value is identified.
This solution addresses KI #1.The USIM has to be provisioned with padding parameters.
SUPI padding needs to be done by the USIM or ME depending on where the SUCI is computed.
The UDM/SIDF has to unpad the padded SUPI.This is a solution to KI #1.
This signaling can be done, for example, by using a new protection scheme identifier.
The UDR maintains an injective map between the SUPIs and their unkeyed hashes.
Therefore, the length of the hash function has to be chosen in a way so that the probability of collision is astronomically small.
If the network is already overloaded (i.e. barring control information is broadcasted), the UE uses its configured Access Identity.
Therefore, the ability to identify a group of UEs using priority access as they move through the network is only partially minimized by this solution.
The target would determine if the source node has requested the UE to encrypt the cause value based on an indication received from the UE.
In this case, the UE will indicate in the RRCResumeRequest message on whether the cause value has been encrypted or not.
During the UE context retrieve procedure, both the source node and the target node indicates to one another whether they support encryption/decryption.
Accordingly, the decryption The symmetric key to encrypt/decrypt the resumeCause is denoted by KRRCResenc.
The target node indicates with a flag in system information that the target node supports encryption of the resume cause.
The target node receives the resume request message and based on the I-RNTI value it determines which node is the source node for this UE.
The target sends a UE context fetch request message to the source.
The target node initiates the procedure by sending the XnAP RETRIEVE UE CONTEXT REQUEST message to the source node.