The present document investigates the security and privacy aspects of Ranging based services and sidelink positioning in 5G system.
The potential solutions addressing the security and privacy issues specific to Ranging based services and sidelink positioning.
DoS Denial of ServiceProSe Proximity based ServiceV2X Vehicle-to-EverythingAs per TR 23.700-86clause 4.3, both Ranging-based services and Sidelink Positioning services are based on a common architecture.
NOTE 1: How AMF1 performs service authorization and privacy checking is not addressed in the present document.
In addition, for Ranging/Sidelink Positioning services, the information exchanged during SR5 direct communication between the UEs is location related, which is security/privacy sensitive.
This key issue details "Unicast/one-to-one operation is assumed as baseline for exchange of SLPP signaling between UEs.
This solution resolves Key Issue #1 for privacy protection for Ranging/SL Positioning services.
In addition, configuration information is exchanged between the UEs to decide the entity for result calculation.
UE1 and UE2 UE1 gets the ranging request from the application layer, UE3 or 5GC NF.
The ranging request includes the consumer info and/or the purpose of ranging positioning.
For example, if UE2 does not authorize the ranging positioning for the purpose or the consumer, the reject message with cause will be responded.
If UE2 wants to change result calculation entity, for example due to its privacy consideration, result calculation entity is included.6.
Result calculation entity and ranging result sharing will be negotiated to limit the entity who can acquire the ranging result.
Hence, the ranging result will not be disclosed to undesired UEs.
This solution introduces a method for authorizing the 5GC NF which initiates SL positioning service targeting at specific UEs.
UE1 and UE2 refer to SL Reference UE and Target UE respectively for SL Positioning service.1.
The 5GC NF sends the SL positioning service request to the GMLC.3.
The UDM checks the authorization info of UE1 and UE2 against their subscription data respectively based on the UE1 ID and UE2 ID.5.
Therefore, the application server/AF needs to be further authorized on whether it is allowed to acquire Ranging info of the involved specific UEs.
Conditionally, if both UEs grant authorization which is restricted in a certain area, the GMLC/NEF proceeds to step #5.
In addition, the GMLC/NEF invokes a Nudm_UECM_Get service operation towards the UDM of UE1/UE2.
The UDM returns the network addresses of the current serving AMF of UE1/UE2.
The area granularity could be detailed in the UE privacy profile for Ranging in UE subscription.
NOTE 4: If UE1 and UE2 are managed by different AMFs, the GMLC/NEF sends messages to the corresponding AMFs respectively.
Then the AMF responds the Namf_Location_ProvideLocationInfo Response to the UDM and the UDM responds the Nudm_ParameterProvision_Get Response to the GMLC/NEF.
A UE SL Reference UE capable of handle position signal and Server SL Positioning UE capable of location calculation).
The solution requires that the UE sends its own role in Ranging/SL positioning service to the network during discovery procedure.
The UE can obtain the discovery security material only after its role is authorized by the Ranging Server or the UDM.
If the authorization with the Ranging Server or the UDM of A-UE is successful, the 5G DDNMF/PKMF of A-UE generates Discovery Security Material.
M-UE sends a Discovery Request message including its assigned role for the requested service.8.
The Ranging Server or the UDM returns an Authorization Response indicating whether the authorization is successful.15.
This solution proposes a token based method as in OAuth 2.0 to meet the above requirements.
The network The token is signed by the network with a private key and can be verified by the UE using the public key.
Based on the token, the UE can independently check the authorization of peer UE during the Discovery procedure and the PC5 security establishment procedure.
The AMF receives a Sidelink positioning request from any 5GC NF or AF.3.
The LMF decides to use the network assisted Sidelink positioning for Target UE.
The LMF triggers the discovery of a Located UE for positioning assistance or performs Sidelink positioning capability negotiation with Target UE.4.
If the Located UE ID is provided by the LMF, Target UE performs Model B discovery with the selected Located UE.
A discovery by listening to announcement message send by the Located UE.
The Located UE provides the Service Code and optionally its token in the discovery message.
Once receiving the discovery messages, the Target UE verifies the discovery message and optionally the token.
If the authorization checking is successful, the Target UE responds to LMF with the Located UE ID.
If required, the Target UE also responds with the Target UE/Located UE's Sidelink positioning capability.7.
The Target UE establishes a PC5 link with the located UE for the SL positioning measurement as defined in.
The Located UE and Target UE also exchange their tokens during the PC5 link establishment procedure for role authorization of each other.
The Target UE performs Sidelink positioning procedure with the Located UE, and obtains the Sidelink positioning measurement data.
Figure 6.5.2-2: Security for Network Assisted Sidelink Positioning with Partial Network Coverage5.
If the authorization checking is successful, the Target UE establishes a PC5 link with the located UE for the SL positioning measurement as defined in.
The Located UE and Target UE also exchange their tokens during the PC5 link establishment procedure for role authorization of each other.
The rest of the procedure of Sidelink Positioning service is performed between the Located UE and the network.
Protection of authorization token and RSC in DCR can be done in a similar way as described in TS33.503 .4.
Figure 6.5.2-3: High-level Procedure of PC5 Security between Reference UE and Target UE6.
The Reference UE derives KNRP and other security material similar as the Target UE in step #5.8.
The Reference UE and Target UE continue with the rest of procedure for the Ranging service over the secure PC5 link.2.
Protection of authorization token and RSC in DCR can be done in a similar way as described in TS33.503 .4.
The Reference UE derives KNRP and other security material similar as the Assistant UE in step #5.8.
The Reference UE and Assistant UE continue with the rest of procedure for the Ranging service over the secure PC5 link.
This solution addresses Key Issue #4 on protection of direct communication.
The SLPKMF checks whether UE-1 is authorized to use SL Positioning service.
If authorized, the SLPKMF sends a SLPK and SLPK ID to UE-1.6.
The SLPKMF of UE-1 The SL positioning service authorization check 12.
If the communication can be established directly between the SL Positioning Client UE and Reference/Target UE, the ranging result is carried over PC5 link.
When Application exposure API is used, ranging result is sent to the SL Positioning Client UE over user plane.
The 5G DDNMF/PKMF in the HPLMN of the Announcing UE returns the corresponding Code Security Parameters.
The Code Security Parameters provide the necessary information for the Announcing UE to protect the information in the DCR message.
The 5G DDNMF/PKMF of the Announcing UE also includes the chosen ciphering algorithm in the Discovery Response message.
The 5G DDNMF/PKMF determines the chosen ciphering algorithm based on the Ranging Service Code and the received UE security capability in step 1a.
The UE stores the chosen ciphering algorithm together with the Ranging Service Code.1b.
Announcing UE and Monitoring UE) or provisioned by the network e.g. during Service Authorization and Provisioning procedure.7.
The Announcing UE responds with a Direct Security Mode Complete message to the Monitoring UE as specified in.9.
The Announcing UE and the Monitoring UE perform the Ranging/SL Positioning measurement.1a.
The Assistance UE sends a Discovery Request message to its 5G DDNMF/PKMF in order to get the associated code security parameters.
The 5G DDNMF/PKMF The Assistance UE stores the chosen ciphering algorithm together with the Ranging Service Code.1b.
UE2 receives the Direct Communication Requests from the Assistance UE-1 and Assistance UE-2.
UE2 verifies the DCR message by using the code security parameters and choose one Assistance UE (e.g. Assistance UE-2).
UE2 derives the session key (KNRP-SESS) from KNRP and then derive the confidentiality key (NRPEK) (if applicable) and integrity key (NRPIK).
UE2 sends a Direct Security Mode Command message to the Assistance UE-2.
This message includes the chosen PC5 security algorithm, nonce 2', and is protected as specified in.9.
Once receiving the Direct Security Mode Complete message from the Assistance UE-2, UE2 sends the Direct Communication Accept message.12.
The secure PC5 link between UE1 and UE2 via the Assistance UE-2 is established.
To secure the link establishment, the security materials (i.e. the long term credentials) are used.
By reusing the direct security establishment procedure specified in, the peer Ranging UEs can authenticate each other and protect the Ranging/SL Positioning information.
Which identifier is used in the Ranging/SL Positioning needs to be coordinated with stage 2 work.
This solution proposes that the UE's exchange authorization tokens after PC5 link establishment.
The token has an expiration time (i.e. a corresponding lifetime) and is signed with a private key.
The network also provides the public key to the UEs to be used for verifying the token from other UE's.
The Target UE and the Located UE are provisioned with the discovery security materials and request authorization tokens when they are in1.
The Target UE sends the Direct Security Mode Complete message to the Located UE.7.
The Target UE and the Located UE exchange the authorization tokens in separate signaling messages.8.
Introduction This solution addresses Key Issue #2 on authorization for Ranging/Sidelink Positioning Service.
This level of authorization could be achieved with the existing authorization method during direct discovery and communication establishment as defined in.
Figure 6.11.2-1: Authorization of SL Positioning Client UE during Direct Link Establishment2.
SL Positioning Client UE performs direct PC5 link establishment procedure with UE1 by sending the Direct Communication Request (DCR) message.
Upon receiving Direct Security Mode Complete, UE1 starts to perform the Ranging/SL positioning procedure with the involved UEs (UE1/UE2) respectively.
Figure 6.11.2-2: Authorization of SL Positioning Client UE after Direct Link Establishment2.
SL Positioning Client UE and UE1 establish a PC5 link, which is protected using the PC5 direct communication security mechanism defined in.4.
The message contains at least the SL Positioning Client UE info, UE1/UE2 info and the Ranging Service Code.5b.
The message contains at least the Client UE info, the involved UE info (UE1/UE2 info) and the Ranging Service Code.6b.
The Ranging/SL positioning server returns the authorization result to the PKMF/PCF of UE1.8a.
If the authorization is successful, UE1 starts to perform the Ranging/SL positioning procedure with UE2.
UE1 calculates the ranging result between the involved UEs and responds to the SL Positioning Client UE with the Ranging service response.
The ranging service response includes the ranging result between the involved UEs (UE1/UE2).1.
The message includes at least the Ranging service code for which the discovery is performed.3.
The PKMF/DDNMF/PCF of UE1 generates the discovery security materials for UE1 according toby associating the discovery keys with the Ranging service code.
The Client UE sends a Discovery Request message to its PKMF/DDNMF/PCF.
The message includes at least the Ranging service code for which the discovery is performed.
If the authorization fails, the PKMF/DDNMF/PCF of the Client UE returns a Discovery Response to the Client UE with a failure cause.12a.
If the check with Ranging/SL Positioning Server succeeds, the PKMF/DDNMF/PCF of UE1 responds to the PKMF/DDNMF/PCF of the Client UE with the discovery security materials.13.
The PKMF/DDNMF/PCF of the Client UE provides the discovery security materials to the Client UE.15.
The Client UE sends a ranging service request to UE1, requesting Ranging estimation between UE1 and UE2.
UE1 returns to the Client UE the ranging result of UE1/UE2.Authorization through the network during discovery is already supported by the relevant 5GC NFs.
The UE only needs to determine when to request authorization from the network in between the procedure.
The detailed check for per UE authorization is done by the Ranging/SL Positioning server.
The definition of the PC5 security policies follows the definition in 5G eV2X inand/or in ProSe in.
The Ranging/SL Positioning signalling are protected based on the PC5 UP security policies.
This solution addresses the first three security requirements of Key Issue #4.
Long-term credentials can be preconfigured in the UE by Ranging application providers or provided by Ranging applications on the UE.
If RSPP signalling on SR5 reference point is carried over PC5-U, SR5 security policies are applied for PC5-U security activation.
The mechanism proposes to provision security materials to the UEs which belong to a particular group for a SL positioning service.
Note that this solution supports both in-coverage and out-of-coverage UEs by provisioning multiple sets of security materials associated with different expiry times.0a and 0b.
The UE is provided with the Ranging/SL positioning application identifier during the parameters/policy provisioning for Ranging/SL positioning service as specified in clause 5.1 of.
NOTE: whether V2X UEs can support the same procedure would be determined in stage 2 work.1a.
The UE establishes a secure connection with the Sidelink Positioning Key Management Function (SLPKMF) based on the security procedures specified in clause 5.2.5 of.
The UE sends a Key Request message to Sidelink Positioning Key Management Function (SLPKMF) including the Ranging /SL positioning application identifier.
NOTE 8: Whether group member ID is provisioned by the network or self-selected will be decided during normative work.3.
The UE protects the messages as described in clause 6.15.2.2.1, and sends the messages to the group.4.
The UE performs a Key Request procedure to get security materials from the SLPKMF.
If the network configuration is to use integrity protection, calculate MAC of the message header and the Payload based on the chosen integrity algorithm.
The integrity algorithms specified in Annex D inare used to calculate MAC.
If the network configuration is to use confidentiality protection, add confidentiality to the Payload and MAC based on the chosen ciphering algorithm.
The ciphering algorithms specified in Annex D inare used for the confidentiality protection.
NOTE: privacy for the Group ID and Group member ID is not addressed in the present document.
This solution introduces a method to preserve the privacy of the Located UE when it is being discovered and selected by the Target UE.
The method of UE privacy profile check specified for LCS incan be reused.
Figure 6.16.2-1: Privacy Check of the Located UE during the Discovery Procedure â€“ Model A1.
The UDM returns the privacy profile of the Located UE to the DDNMF/PCF/PKMF via Nudm_SDM_Get response.7a.
In this case, Located UE itself can determine whether or not it wants to be discoverable.
Thus, next to the discovery parameters, also a privacy policy Details can be determined during normative work.10.
The DDNMF/PCF/PKMF returns a Discovery Key Response to the UE including the discovery security materials generated in step #7a.14.
The Target UE selects the Located UE by sending a Direct Communication Request (DCR) to the Located UE.16.
If model B is used for discovery, the Target UE broadcasts a solicitation message which contains the Located UE info provided by the LMF.
The Located UE monitors the broadcasted solicitation message to find whether the message contains the Location UE info matching its own UE info.
If there is a match, the Located UE verifies the solicitation message and sends a response message.
When receiving a response from a Located UE, the Target UE selects the Located UE by sending a DCR message.
After checking the Client UE's authorization information, the GMLC also needs to check whether the to-be-measured UEs (UE1/UE2) allow their positions to be exposed.
Figure 6.17.2-1: Authorization of SL Positioning Client UE for Service Exposure through 5GC Network2.
The UE sends an MO-LR Request message to the AMF included in a UL NAS TRANSPORT message.
The MO-LR Request includes at least the info of Client UE and the to-be-measured UEs (UE1/UE2).
The AMF sends a Ranging/SL Positioning Request to the GMLC which also includes the info of Client UE and UE1/UE2.5.
If the authorization fails, the GMLC returns a Ranging/SL positioning response to the AMF with a failure cause.11.
The GMLC sends the UE1/UE2 ranging/SL positioning result to the AMF.This solution fulfils the fourth requirement in KI#2.
After checking the Client UE's authorization information, the GMLC also needs to check whether the to-be-measured UEs (UE1/UE2) allow their positions to be exposed.
For authorizing the Client UE, UE1 sends an Authorization Request message to the AMF via NAS signalling upon receiving the DCR message.
The request contains at least the Client UE info, the to-be-measured UEs info (UE1/UE2 info), and the SL Positioning Service Code.6.
The GMLC sends an Authorization Request to the UDM with the info of Client UE and UE1/UE2.8.
The GMLC returns an SL Positioning Authorization Response to the AMF.13a.
If the authorization is successful, UE1 performs a Direct Auth & Key Establish procedure with the Client UE.
The rest of PC5 link establishment procedure and SL positioning procedure are performed.
The UE only needs to determine when to request authorization from the network in between the procedure.
The privacy check is performed by the GMLC by reusing the mechanism defined in.
Ranging/SL Positioning services, there are use cases in which the UEs can be determined before using the Ranging/SL Positioning services, e.g., public safety, etc.
NOTE 5: How the DRESP MIC code is calculated is left for normative work.
NOTE 6: How the DFP MIC code is calculated is left for normative work.
Step 10: Protected SL positioning data is sent by means of groupcast/broadcast.
In Step 2, UEs may be configured:- with keys as infor usage when Ues are OOC.
Message in Step 6 NOTE 3: The choice of specific security algorithms/keys is left to normative phase.
NOTE 1: How to serve these UEs subscribed with different operators is not addressed in the present document.
The solution proposes a procedure of provisioning broadcast protection keys to Target/Reference UEs when the UEs broadcast/receive Sidelink Positioning data in coverage scenario.
The broadcast protection key provision procedure is shown in the following figure.
The Registration Request The UE includes in the Registration Request an indication that SL positioning broadcast ciphering and/or integrity keys are requested.
NOTE 5: With this solution, a UE only allowed to receive broadcast message can also send fake broadcast message.
It is not addressed in the present document how to prevent the receiving UE from sending fake broadcast messages.
The Target/Reference UEs need to obtain the key packet decryption keys and signature verification keys when they are in coverage.
The Server UEs need to obtain the key packets when they are in coverage.
The Server UEs will distribute the key packets to the Target/Reference UEs when these UEs are out of coverage.
The keys used to protect the groupcast/broadcast messages are generated by LMF or Key Management Function (KMF).
The encrypted and signed key packets are provisioned to Server UEs when they are in coverage.
The groupcast/broadcast protection key provision procedure is shown in the following figure.
In cases where UE comes from different PLMNs and AMF-LMF is used, key synchronization needs to be done between LMFs of different PLMNs.
The AMF-LMF/KMF checks whether the Server UE is authorized to distribute the groupcast/broadcast protection key packets to Target/Reference UEs.
If the UE is authorized, AMF-LMF/KMF returns a list of groupcast/broadcast protection key packets.
signature algorithm of the key packet are left to the normative phase stage.5.
The Server UE checks whether the Target/Reference UE is authorized to receive the groupcast/broadcast protection key packets.
If the UE is authorized, the Server UE returns a list of applicable key packets to the Target/Reference UE.
How the Target/Reference UE is authorized is not addressed in this solution.8.
The Target/Reference UE uses the groupcast/broadcast protection keys to protect groupcast/broadcast messages.
This solution does not specify how to use groupcast/broadcast protection keys to protect groupcast/broadcast messages.
Positioning Group Key (PGK): A key is provided by a KMF to a group member.
Whether the PSK is necessary is not addressed in the present document.
The format of SLPP message for Sidelink Positioning groupcast is shown in the following figure.
If message integrity protection is enabled, calculate MAC of the message, otherwise the MAC field will be filled with all zeroes.
If message confidentiality protection is enabled, decrypt the ciphertext.6.24.2.2.1 Broadcast security key hierarchy- Positioning Encryption Key (PEK): This key is used for message encryption protection.
If message integrity protection is enabled, calculate MAC of the message, otherwise the MAC field will be filled with all zeroes.
This solution addresses the key issue #5.This solution does not address how to provision PGK used in groupcast and PEK/PIK use in broadcast to UEs.
For key provision issue, other solutions in the present document can be considered.
The UE intending to groupcast SLPP signaling (G-UE) sends a Key Request message to its PKMF/DDNMF/PCF.
The message includes at least the Group ID, G-UE info, an indicator of the UE as a groupcaster.
In addition to the Authorization Result, the Ranging/SL Positioning Server also provides the G-UE info of the Group to the PKMF/DDNMF/PCF of R-UE.15.
G-UE starts to groupcast SLPP signaling which is protected by the group keys (e.g. Private key) received from the network.
The groupcast message includes at least the Group ID, GKID, SLPP signaling.
Encrypt SLPP payload (SLPP signaling) using the group key (encryption key).4.
Form L2 message by including the protected SLPP message (SLPP message + MAC) as the L2 payload and append the L2 header (incl.
Verify the message by checking the MAC of the received message using the groupcast key (integrity key).
The UEs do not need to perform discovery procedure and link establishment procedure for broadcasting and/or receiving SLPP signalling.
Hence it is proposed to provision the broadcast keys to the UE as earlier as in Registration procedure.
If the deployment of SLPP signalling broadcast requires that receiving UEs 2.
The AMF of B-UE checks with the UDM whether B-UE is allowed to broadcast SLPP signaling against the UE subscription information.5.
The Central Key Management Function generates the keys for broadcasting SLPP signaling.
The Central Key Management Function returns the broadcast keys (e.g. the private key) in the Key Response to the PCF of B-UE.8.
The AMF of B-UE sends the broadcast keys to B-UE in the Registration Accept.10.
The Central Key Management Function returns the keys for receiving broadcasted SLPP signaling in the Key Response to the PCF of R-UE.
The AMF of R-UE sends the keys for receiving broadcasted SLPP signaling to R-UE in the Registration Accept.
When the timer expires, the UE needs to request new keys by initiating a periodic registration procedure again.1.
The AMF of B-UE sends the stored broadcast keys to B-UE in the Registration Accept.9.
The Central Key Management Function returns the broadcast keys for receiving broadcasted SLPP signaling to the LMF of R-UE.11.
The AMF of R-UE sends the stored broadcast keys to R-UE in the Registration Accept.
The broadcast keys are generated and provisioned by a Centralized Key Management Function during Registration procedure.
The broadcasting and receiving UEs subscribed with different operators can be provisioned with the same set of broadcast keys generated by a single network function.
The receiving UE-x sends an SL broadcast key retrieval request to the corresponding SLPKMF.
The SLPKMF of UE-x determines whether the sending UE-1 and receiving UE-x are with the same HPLMN.
The sending UE-1 encrypts the UE-1-ID and SL positioning assistance data /SL positioning capability using SLPBK.
The SL broadcast key retrieval request message includes UE-x-ID, SLPBK-ID, and encrypted UE-1-ID.
The serving SLPKMF of UE-x determines whether the sending UE-1 and receiving UE-x are with the same HPLMN based on SLPBK-ID.
Otherwise, the serving SLPKMF of UE-x 11) The serving SLPKMF of UE-1 checks whether to return the key based on local policy.
The ranging/SL application server authorizes the request based on UE-x's subscription.
The serving SLPKMF of UE-x sends a key retrieval response to the UE-x, including SLPBK, SLPPKUE-1, key expiration time.
Step14: The decryption stage of the receiving UE-x.NOTE 3b: whether token based authorization is needed is not addressed in the present document.
The sensitive information is resulting in the SL Ranging/Positioning procedure and sent from the responding UEs to the initiator UE.
The Zone ID is defined by RAN2 as indicator of UE1's coarse location information.
The Ranging Application Server authorizes the request e.g. based on the UE1 subscription and stores the Zone ID corresponding to the UE1.
The Ranging Application Server provides the authorization result to the SLPKMF.6.
The SLPKMF provides the group ID, Group Broadcast Key KB and validity time to the UE1 in the broadcast authorization response message.
UE1 deletes the Group Broadcast Key KB after expiration of the validity time.
Security and privacy threats of unprotected broadcast message is not addressed in the present document10.
The SLPKMF sends an authorization request to the Ranging Server for the received responses with respect to temporary groupd ID.
The request contains the UE1 ID, responder UEx ID and respective Zone ID.12.
The SLPKMF provides the Group Broadcast Key KB generated in step 5 to all responding UEx.
Hence, the Target UE and Located/Reference UE can use the provisioned discovery security material to protect the discovery messages.
This solution assumes both Target UE and Located/Reference UE have connectivity to the network, e.g. to retrieve security materials.
The LMF obtains the security materials of discovery security for each pair of Target UE and Located/Reference UE from 5G PKMF.
The LMF can also generate the discovery security material by itself.