The present document studies the security aspects of enhancements for 5G Multicast-Broadcast Services.
The present document studies the security of 5G multicast-broadcast services based on FS_5MBS study in TR 23.757 .
Potential security requirements are identified and possible security solutions are proposed to address these security requirements.
For the purposes of the present document, the terms given in TR 21.905and the following apply.
Different solutions both MBSF and MBSTF or MBSF-C and MBSF-U.specifies the security for the MBS for LTE and before.
It is required that a UE is authenticated and authorised such that only legitimate users are able to participate in a MBS service.
This key issue investigates security protection of 5G MBS PDU sessions/flows at the transport or service level.
To securely transmit data to a given set of users, the MBS traffic needs to be protected to mitigate the potential attacks.
As the security fundamental basis, the keys for protection of MBS traffic are required.
Three configuration options are descripted including (1) No MBSF, (2) MBSF, N33 towards AF and (3) MBSF, MB2-C/xMB-C towards AF.
The keys for protection of MBS traffic are generated in the RAN nodes and distributed to UEs.
The UEs, which belong to a multicast group, acquire the same keys in the RAN node.
The content provider announces the availability of multicast using higher layers (e.g., application layer).4.
The AMF invokes Nsmf_PDUSession_UpdateSMContext, in which information about multicast group is included.
The SMF checks whether the UE is authorized to receive the requested multicast service based on the UE's subscription information.6.
In addition, the SMF sends a security policy for the multicast service to the gNB via AMF.
Security policy indicates whether confidentiality and/or integrity protection needs to be activated or not for all bearers belonging to that MBS service.8.
RAN check whether the MBS security context for this multicast group is available.
MBS security context, which is used for MBS traffic protection, includes the key_ID, K_group_enc, K_group_int, encryption and integrity algorithms.
K_group_enc and K_group_int are used for encryption and integrity protection of MBS traffic respectively.
UE receives and stores the MBS security context for the multicast group.
NOTE 4: The support for mobility of UEs is addressed in other solutions.
Information about multicast group including identifier of the multicast group which UE wants to join, is sent.
If UE is allowed to access the MBS service, UE derives Multicast User Key (MUK).
The parameters are used to form the input string to the KDF including Multicast_group_ID.
If reauthentication is performed, the UE still uses the current MUK.
The UE will also try to process the MBS traffic with its known group key to avoid introducing unnecessary delays.
AUSF derives Multicast User Key (MUK) based on Kasuf and Multicast_group_ID.
When re-authentication runs, the AUSF is not required to generate a new MUK immediately.
If not, MBSF-C generates K_group and derives the K_group_enc and K_group_int.
MBSF-C verifies the token using MUK and distributes the MBS security context to UE if succeeded.
The above text describes the security handling when SMF and MB-SMF are co-located.
If SMF and MB-SMF are deployed separately, MB-SMF requests MUK from AUSF and distributed MUK to MBSF-C.This default approach uses only Step 18a.
Upon reception, a UE first verifies the message authentication code, and if it is correct, it decrypts its transport key.
Key update triggered by a new device joining the group: Message 18a is used to deliver the corresponding transport key to the new UE.
Then, Message 18b is used to distribute a new group key to all UEs.
This solution requires a new security protocol between the UE and the MBSF-C for mutual authentication and transport of the MBS keys.
MBS Traffic Key (MTK) is generated by MBSF and securely distributed to the MBSTF and the UEs through the control plane.
The KID consists of a Key Domain ID and a MTK ID.
The protected multicast data along with the KID are sent to the UE.
This solution, which is based on existing EAP based secondary authentication, addresses the key issue #1 Security of authentication and authorization for multicast communication service.
The solution is based on the concluded architecture in TR 23.757 .
The (MB-)SMF determines that authentication and authorization is needed for the multicast session based on the subscription data.
The (MB-)SMF sends a message to the UE to request the EAP identity used for the multicast session authentication and authorization.
The (MB-)SMF sends the received EAP identity and multicast session ID to the AAA server through a (MB-)UPF.
This solution proposes how the authorization revocation is performed, for KI#1.
The UDM/UDR will accordingly instructs the SMF to release the corresponding resources established for the user for the multicast service.
The NEF is involved in the provisioning if the content provider belongs to a 3rd party.2.
The (MB-)SMF subscribes to the UDM/UDR on the changes of the multicast information including the authorization information.
The UDM/UDR notifies the (MB-)SMF when the authorization for a UE to join the multicast service/application is revoked.
The multicast session ID and UE identifier (i.e. SUPI) is included in the notification.
The UE requests a PDU session establishment or modification to receive an MBS service.
The MBSTF computes the MAC-I using KMBS, and check if it is the same with the received MAC-I from UE.
The AF of the content provider provides the multicast configuration information to UDM.
The information includes UE authorization information and indicates whether the security protection provided by PLMN is needed.
The NEF is involved in the provision if the content provider belongs to a 3rd party.
The request is forwarded to the (MB-)SMF through the control plane.
Multicast session join operation via UP is out of scope of the present document.3.
If the security protection provided by PLMN is needed and MTK and KID is available, the UDM/UDR replies with the stored MTK and KID.
(MB-)SMF provisions the generated MTK and the KID to the MBSF-U.7.
The above text descripts the security handling when SMF and MB-SMF are co-located.
If SMF and MB-SMF are deployed separately, MB-SMF performs step 2-6.
The keys for protection of MBS traffic are generated in the RAN nodes and distributed to UEs.
The UEs, which belong to a multicast group, acquire the same group keys in the RAN node.
Key update triggered by a new device joining the group, and 4.
The transport keys and the group key The MUK is used to securely deliver transport keys in a point-to-point connection.
The transport keys are used to securely deliver the group key.
In this approach, a multicast group with N members is divided into M disjoint sets S_i of UEs with i={1,â€¦,M}.
The transport keys are used to securely deliver the group key updates as part of the data exchanged over the regular MBS traffic.
Then, the UE verifies the message authentication code, and if it is correct, it decrypts the new group key.
Freshness can be achieved by using the same freshness counter as used for the distribution of MBS traffic.
The MSK is distributed over the multicast channel protected with the TKs.
The MSK is used to protect the update the GK over the multicast channel.
This MGKM1 message transports the group key protected with M different transport keys.
The total overhead is obtained by adding the number of protected keys that need to be sent altogether through unicast and multicast messages.
The green line (communication optimized approach 2) shows the best performance in all cases.
The performance of the blue line improves compared with the performance of the purple line when the number of MBS membership changes increases.
Users joining an MBS User Service - To address 2) and 3), a new GK needs to be distributed to all devices.
In the case of the communication optimized approach, the corresponding TK needs to be updated first.
In Step 1, the MBSF has to generate M different Transport Keys (TKs) and an MSK and distribute them to the UEs.
As in the communication optimized approach 2: (1) each UE has a unique security key (NAS security), a TK, an MSK, and an MTK.
This clause uses the term MTK as in Solution #11 whose role is equivalent to GK used in this clause above.
In Step 5, the MBSF distributes the new TK to the (MB-)SMF.- In Step 8, the MBSTF uses MTK2 to protect the MBS traffic.
Performing the key update when a single UE has joined/left/been removed minimizes the security risk.
This is shown in Figure 6.9.3-1 for N= 400 (blue), (red), (green), (black), and 0 (purple).
It is further assumed that the group key is updated as soon as key update condition is triggered.
Rekeying token list contains many pre-generated re-keying token needed for this particular MBS session.
Rekeying ID and respective rekeying token list is stored in RAN for future use.
RAN and UE generates independently the encryption and integrity keys for this MBS session.
: The content provider announces the availability of multicast using higher layers (e.g., application layer).
The announcement includes at least the multicast address of a multicast group that UE can join.
Rekeying token list contains many pre-generated re-keying token and corresponding ids needed for this particular multicast group management.
Step 10a: UPF(MB-UPF) sends multicast PDUs in the N3/N9 tunnel associated to the multicast distribution session to the RAN.
There is only one tunnel per multicast distribution session and RAN node, i.e., all associated PDU sessions share this tunnel.
The UEs which have left the multicast group are excluded from the to be paged list.
Step 4: UEs which were in Idle mode establishes connection to the respective base stations.
UEs which were active UEs (already in connected mode) are aligned and will be in connected mode with the respective RAN.
This would result in different multicast keys (both integrity key KMTint and encryption key KMTenc) at every RAN node.
Step 8: Fresh new multicast keys (both integrity key KMTint and encryption key KMTenc) are generated at UEs using rekeying token.
Target and source RANs will use the same keys for that particular MBS session.
Assume Source NG-RAN has received the multicast group token, which is same for target NG-RAN.
Example: rekeying_token_A is received in source NG-RAN and corresponding MBS keys are generated.
Similarly rekeying_token_B is received in target NG-RAN and corresponding MBS keys are generated.
UE_A, UE_B which is connected to target NG-RAN will have same MBS key_B, which can be used for decrypting the incoming traffic.
Each of the SMF generates a different multicast group token, which will be used to protect the same MBS session.
Therefore in UE mobility where the SMF changes, the UE has no multicast group token generated by the new SMF.
Before the UE can use the MBS session, the new SMF has to sends its multicast group token to the UE.6.11.1 Introduction3.
MBSF triggers the MTK update based on the changes of authorization info or the key lifetime of MTK1.
For example, if the number of UEs whose authorization is revoked reached the threshold, the MBSF triggers the MTK update.
SMF distributes MTK2 and KID2 to the authorized UEs in the connected state whose MBS sessions are not released.
For example, SMF Confirmation for update notification is responded to (MB)-SMF.
With the confirmation info, (MB)-SMF determines to activate MTK2 based on local policy.
For UEs in idle or inactive state UEs, the updated key are delivered when UE joins or activates the MBS session.8.
MBSF decides to trigger the MTK update procedure based on the changes of authorization info or the key lifetime of MTK.
The new MTK and KID are sent to UE and MBSTF respectively.
Figure 6.12.2-1: Message flows for MBS key delivery and MBS traffic protection1.
The UE requests a PDU session establishment or modification to receive an MBS service.
NOTE 1: The key management function is located in the MBSTF as in BM-SC .4.
The UE receives the Multicast Traffic Key (MTK) protected using MSK from the MBSTF.
The MTK can be delivered either a unicast or a multicast message.
The MTK is used as a root key to derive application/protocol specific keys to protect (e.g., encrypt or integrity protect) MBS service traffic.
Note 3: More details on the use of AKMA for MUK rekeying are not addressed in the present document.
This solution addresses Key issue #2 and 3 to protect the MBS key and traffic at service-layer.
MBSF-U decides to trigger the MTK update procedure based on the changes of authorization info or the key lifetime of MTK.
The new MTK and KID are sent to UE and MBSTF respectively.
The MSK update procedure by MBSTF to the UEs incurs overhead proportional to the number of UEs in connected state that joined the MBS session.
The MB-SMF fetch the MBS session security context data from the KMS.
The DL NAS message is protected using the NAS security context.7.
NEF/MBSF sends a MB Session Start (TMGI, Service Requirement) message to the MB-SMF.
- PCI and ARFCN-DL: are included in the key generation as to bind the key to a specific RAN Cell.
- CountMBS: is used as a freshness parameter in refreshing the key.
The NG-RAN associates a counter, called a CountMBS, with the MBS security context.
The NG-RAN maintains the value of the counter for a duration of the current MBS security context between UE and NG-RAN.
The UE and the NG-RAN maintains the CountMBS for lifetime of the KMBS-RAN.
The CountMBS is incremented by the NG-RAN for every new computation of the KMBS-RAN.
The NG-RAN sends the value of the CountMBS (used to generate the KMBS-RAN) to the UE.
The UE accepts CountMBS value that is greater than stored CountMBS value.
The size of the RANDMBS Note 1: How MB-SMF or KMS selects AS security algorithms is not addressed in the present document.
The MBS keys used to protect the MBS traffic needs to be updated:Supporting all deployment scenarios.
Whenever there is no NAS confidentiality protection, KMBS will be sent in the clear, which is a huge damage for MBS service.
This solution proposes a method to protect the KMBS used for MBS traffic protection based on KMBS-UE which is derived based on KAUSF.
With this solution, KMBS delivery from MB-SMF to UE can be confidentially protected.
Solution details Figure 6.14.2-1: The procedure of key delivery of KMBSStep 0a: UE initiates the Primary Authentication and establishes the KAUSF with AUSF in HPLMN.
AMF sends MBS Key Request to AUSF to ask for the encryption key.
Note 2: It is not addressed whether the KMBS will be used as the root key or the session key.
The MTK is used as a root key to derive application/protocol specific keys to protect (e.g., encrypt or integrity protect) MBS service traffic.