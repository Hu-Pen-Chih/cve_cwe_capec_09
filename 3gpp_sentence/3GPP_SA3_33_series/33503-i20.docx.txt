Restricted ProSe Application User ID RSC Relay Service CodeUP User PlaneUTC Universal Time CoordinatedThe overall architecture for 5G ProSe is given in.
The 5G PKMF interacts with the 5G ProSe-enabled UE using procedures over PC8 reference point defined in clause 4.2.2.
It is used to transport security material between two 5G PKMFs.
The reference point between the AUSF and Prose Anchor Function (PAnF).
The 5G System The open 5G ProSe Direct Discovery security procedure is described as follows.
If the Announcing UE wants to send announcements in the VPLMN, it needs to be authorized from the VPLMN 5G DDNMF.
The 5G DDNMF in the HPLMN requests authorization from the VPLMN 5G DDNMF by sending Announce Auth.() message.4.
The 5G DDNMF stores the Discovery Key with the ProSe Application Code.
The Announcing UE obtains a value for a UTC-based counter associated with a discovery slot based on UTC time.
The counter is set to a value of UTC time in a granularity of seconds.
The 5G DDNMF in the HPLMN of the Announcing UE sends Monitor Resp.
message to the 5G DDNMF in the HPLMN of the Monitoring UE.10.
The Relay Discovery Key Request message includes the Relay Service Code (RSC) and the 5G ProSe UE-to-Network Relay's PC5 security capability.3.
The UE stores the chosen PC5 ciphering algorithm together with the ProSe Restricted Code.
The 5G DDNMF in the HPLMN of the Monitoring UE sends an authorization request to the ProSe Application Server.
For 5G ProSe UE-to-Network Relay discovery, the 5G DDNMF of the Remote UE NOTE 2a: 5G DDNMF from PCF, or based on local configuration).9.
The Code-Receiving Security Parameters provide the information needed by the Monitoring UE to undo the protection applied by the Announcing UE.
The HPLMN ID of the 5G ProSe UE-to-Network Relay is used to identify the discovery security materials.
Npkmf_Discovery_MonitorKey service operation is used to obtain the discovery key from the 5G PKMF for monitoring in the PLMN.
The 5G DDNMF in the HPLMN of the Announcing UE NOTE 4: The chosen PC5 ciphering algorithm is associated with the ProSe Restricted Code.
The four least significant bits of UTC-based counter are transmitted along with the protected discovery message.12.
In order to find such a matching message, it processes the message.
If the Monitoring UE was not asked to send Match Reports for MIC checking, it stops at this step from a security perspective.
If such a Match Report is sent, then there is no security functionality involved.
The 5G DDNMF in the HPLMN of the Monitoring UE 16.
The command indicates that this is for ProSe Response (Model B) operation, i.e. for a Discoveree UE.
The Relay Discovery Key Request message includes the Relay Service Code (RSC) and the 5G ProSe UE-to-Network Relay's PC5 security capability.3.
The 5G DDNMFs in the HPLMN and VPLMN of the Discoveree UE exchange Announce Auth.
If the Discoveree UE is not roaming, these steps do not take place.
The Relay Discovery Key Request message includes the RSC and the 5G ProSe Remote UE's PC5 security capabilities.
For 5G ProSe UE-to-Network Relay Discovery, Relay Discovery Key Request and RSC are used instead of Discovery Request and RPAUID.
Npkmf_Discovery_DiscoveryKey service operation is used to obtain the discovery key from the 5G PKMF for a discoverer UE in the PLMN.8.
The 5G DDNMF in the HPLMN of the Discoveree UE For 5G ProSe UE-to-Network Relay discovery, this step is skipped.
The 5G DDNMFs in the HPLMN and VPLMN of the Discoverer UE exchange Announce Auth. messages.
If the Discoverer UE is not roaming, these steps do not take place.
NOTE 5: Match Reports are not used for the MIC checking of ProSe Query Codes.
The 5G DDNMF in the HPLMN of the Discoverer UE 19.
The discoveree 5G ProSe End UE replies to the 5G ProSe UE-to-UE Relay with the UE-to-UE Relay Discovery Response message.
Then, 5G ProSe UE-to-UE Relay sends the UE-to-UE Relay Discovery Response message to the discoverer 5G ProSe End UE.
The unicast mode 5G ProSe Direct Communication procedures are described in.
Unicast mode 5G ProSe Direct Communication is used by two UEs that directly exchange traffic for the ProSe applications running between the peer UEs.
The 5G ProSe Remote UE gets the 5G PKMF address from the 5G DDNMF of its HPLMN.
The 5G ProSe UE-to-Network Relay gets the 5G PKMF address from its HPLMN in the same way as described in step 0a.1a.
The 5G ProSe Remote UE sends a UP-PRUK Request message to its 5G PKMF.
The message indicates that the 5G ProSe Remote UE is requesting a UP-PRUK from the 5G PKMF.
If the 5G ProSe Remote UE receives the message containing the GPI, it processes the GPI as described in TS 33.223 .
The AUSF of the 5G ProSe Remote UE performs the UE authentication by verifying the received information as described in TS 33.501 .
When receiving a Npanf_ProseKey_get request in such case, the PAnF responses with CP-PRUK not found.12.
The AUSF of the 5G ProSe Remote UE EAP Success message The AUSF of the 5G ProSe Remote UE 14.
The Krelay-sess is derived per unicast link same as KNRP-sess specified in.
During activated unicast communication session between the UEs, the Krelay-sess The keys for confidentiality and integrity algorithms are derived directly from Krelay-sess.
If PC5 UP security policies are included in the PC5 security policies, they are negotiated but not enforced by the 5G ProSe Layer-2 UE-to-Network Relay.
This clause also describes a mechanism to integrity protect the DCR message when DUIK is provisioned for discovery.
The 5G ProSe Remote UE encrypts the UP-PRUK ID/CP-PRUK ID and RSC using the code-receiving security parameters used for discovery.
If the UE is configured with Discovery User Scrambling Key (DUSK) but not DUCK, KDCR is set to DUSK.
If the UE is configured with DUIK, the DCR integrity key KINT is set to DUIK.
If the UE is configured with DUIK, the DCR integrity key KINT is set to DUIK.
A 5G ProSe enabled UE acting as 5G ProSe UE-to-Network Relay Dedicated RSC(s) are used for relaying of emergency service as specified in.
The 5G ProSe UE retrieves discovery material with the procedures as specified in clause 6.1.3.2.
For UP based security procedure, the 5G ProSe Remote UE retrieves UP-PRUK as specified in step 1 of clause 6.3.3.2.2.1.
All key derivations proceed as if they were based on a KNRP or KNR_ProSe generated from a successful authentication run.3b.
This clause specifies the security requirements and the procedures of the broadcast mode 5G ProSe Direct Communication.
There are no particular procedures defined for securing the broadcast mode 5G ProSe Direct Communication.
The 5G System This clause describes the security requirements and the security procedures that are specifically for 5G ProSe UE-to-UE Relay Communication defined in.
The security requirements for 5G ProSe Layer-3 UE-to-UE Relay and 5G ProSe Layer-2 UE-to-UE Relay are defined in clause 6.6.2.
Then, the source End UE broadcasts a Discovery Solicitation message including the selected RSC.
Service operation name: Npkmf_Discovery_AnnounceAuthorizeInput, Required: User Info ID, RSC.Output, Required: Authorization result.
Service operation name: Npkmf_Discovery_MonitorKeyInput, Required: User Info ID, RSC, PC5 UE security capability.
Service operation name: Npkmf_Discovery_DiscoveryKeyInput, Required: User info ID, RSC, PC5 UE security capability.
The NF consumer requests the PAnF to store the Prose context info (i.e. SUPI, CP-PRUK, CP-PRUK ID, RSC).Input, Optional: None.Output, Optional: None.
Description: The NF consumer requests CP-PRUK from the PAnF.Input, Optional: None.Output, Optional: None.