The following clauses include information about the previous security study results documented in TR 33.890and the related work documented in TR 23.700-77 .
The third party specific user identity handling work in TR 33.890and TR 23.700-77is taken into account if applicable.
The UE can access the IMS network directly or via a SIP trunk as well.
The potential transfer of the Avatar metadata between IMS networks can potentially be manipulated by intermediary network entities.
The 5G system Editor's Note: Security and privacy threats and solutions depend on SA2 architecture and procedures.
The third party ID information is related to an IMPU and is either provided to the HSS or IMS-AS (as described below).
In the latter case the HSS provides a URI to the IMS AS so the third party ID information can be requested.
The IMPU and third party ID information or URI to fetch that information is provisioned in the HSS before the SIP INVITE is sent.
Figures 6.1.2-1 and 6.1.2-2 (given below) show the procedures for the originating and terminating networks respectively.
Figure 6.1.2-1: Originating network procedures for authorising/verifying the third party ID information2.
The CSCF forwards the SIP INVITE to IMS AS for processing of third party user identity service based on the included IMPU.
The IMS AS sends a request to HSS to retrieve the third party ID information.5.
The HSS returns either the third party ID information ID or a URI to fetch the third party information ID to the IMS AS.7-8.
IMS AS sends the third party ID information to the Signing Server and receives a Personal Assertion Token (PASSporT) in the response.10a.
Figure 6.1.2-2: Terminating network procedures for authorising/verifying the third party ID information11.
The SCSF sends the SIP INVITE to IMS AS based on UE subscription data and network policy.
The CSCF forwards the SIP INVITE (including the verified third party ID information).onto UE-B for rendering and presentation to the user.
EvaluationThis solution addresses the Key issue #1 "Third party specific user identities".
This solution proposes to use the existing Ms reference point and procedures as described in TS 24.229and STIR/SHAKEN frameworkwhile adopting draft-ietf-stir-passport-rcd-26 .
If there is only one RCD record expected to be fetched, then nothing is inserted by the UE.
The 3rd party (Enterprise) network can be connected to the serving IMS network via UNI (UE to Network Interface) or NNI (Network to Network) interfaces.
The serving IMS network handles outbound SIP calls from the Third Party.
There are several options how and where the RCD data of a 3rd party user is signed and verified.
The Originating IMS network is assumed to have a secure channel to the 3P ID Server which includes the Rich Call Data information.
to ATIS-094 RCD can be included in the PASSporT of a SIP Identity header.2.
The IBCF forwards the SIP request to the IMS system entity.
The STI-AS signs the SIP identity header according to STIR/SHAKEN framework and draft-ietf-stir-passport-rcd-26.7.
The originating IMS system routes the call to the egress IBCF.
Then the SIP INVITE is routed over the NNI through the standard inter-domain routing configuration.
The terminating service provider’s ingress IBCF receives the INVITE over the NNI and forwards to the terminating IMS systems.9.
The SIP INVITE with the verstat parameter is sent to terminating SIP UA.13.
The Originating IMS system sends 18X and 200 to originating SIP UA.
The originating IMS system checks whether the IMS subscription of the calling UE is authorized to use 3P IDs.
If no RCD data exist for this user (IMS identity), the rest of 3P ID related steps are not executed during the call set-up.
The STI-AS returns the signed SIP identity header back to IMS system.7.
The terminating IMS systems invoke the STI-VS to verify the signed SIP identity header.10.
The SIP INVITE with the verstat parameter is sent to terminating SIP UA.12.
The Originating IMS system sends 18X and 200 to originating SIP UA.
This enables calling number verification using signature verification and attestation information based on the STIR/SHAKEN framework.
If HSS returns concrete RCD to the IMS AS in this step, HSS 5.
The IMS AS/CSCF calls STI-AS to sign the SIP header, e.g. call-info, which including RCD URL or RCD of the third party identity.7.
For the originating UE, subscription data for the usage of third party specific user identity is configured in the HSS.
The third party assigned a token to the UE for the authorization of third party specific ID via application layer.
The third party Authorization Server is authorized by NEF to request allocation of designated IMPU and associated Service Profile for the UE to HSS.
The allocated IMPU is received and configured in the UE in IMS registration procedure.
(For option B) Third party Authorization server is authorized by the serving IMS network to provide third party specific user identity.
The UE interacts with the third party via application layer to receive a token for the authorization of third party specific ID.
For option B, the authorization can be done using the token received in the INVITE as mentioned above or as described in clause 6.4.2.2.
This clause provides an alternative authorisation method for option B at step 3 in clause 6.4.2.1.This solution meets the requirements of KI#1.
The Base Avatar Repository is used to store and retrieve the avatar models.
After that, UE1 sends the token to the MF/MRF in this step or before Step 3.
Step 5. MF/MRF requests to download the avatar model from the BAR, including parameters of token and Avatar ID.Step8.
The UE-A performs the XR media rendering negotiation with the XR Application Server.
The UE-A generates and sends UE-A's attestation to the XR Application Server.
Application data channel is established between UE-A and IMS network, and media re-negotiation 6.
After DAC retrieves UE-A’s public key based on avatar ID in UE-A’s attestation, DAC verifies the signature in UE-A's attestation using the UE-A's public key.
The XR Application Server sends the avatar object to MF/MRF and requests rendering of the avatar.9.
The MF/MRF performs the rendering using the UE-A's avatar object and the data received from UE-A in step 8.11.
The rendered avatar media is sent back to the UE-A as feedback.2.
The UE-A performs the XR media rendering negotiation with the XR Application Server.
The UE-A generates and sends UE-A's attestation to the XR Application Server.
Application data channel is established between UE-A and IMS network, and media re-negotiation 6.
After DAC retrieves UE-A’s public key based on avatar ID in UE-A’s attestation, DAC verifies the signature in UE-A's attestation using the UE-A's public key.
The DAC responds with the protected UE-A's avatar object and ephemeral public key of the DAC.8.
The UE-A decides to use UE-B centric rendering of an avatar object.5. XR Application Server requests avatar object using UE-A's attestation.7.
The XR Application Server sends the protected avatar object and ephemeral public key of the DAC to UE-B, and requests rendering of the avatar.9.
IMS avatar communication aims to provide avatar media rendered calls between the UE-A and the UE-B over IMS network.
There're solutions in TR 23.700-77 proposed to use application data channel (DC) to download avatar object (or representation/metadata) for avatar media rendering.
An avatar object is stored in a data storage entity (called as Digital Asset Container (DAC).
The avatar object is identified by an avatar id and can be fetched from the DAC using the avatar id.
This solution proposes security procedures to protect avatar id and object at rest, in transmission and in use.
: SHAKEN framework can be used sign and verify the avatar-id.
The UE-A decides to request network media rendering based on its status such as power, signal, computing power, internal storage, etc.
The UE-A selects the Avatar-id of the avatar from the Avatar-id list downloaded from the first step, which is intended to use for the call.
The UE token is sent to XR AS during ADC establishment or via ADC after the ADC establishment.5(Optional).
NOTE 6: The procedure assumed the DAC is inside IMS or 5GC network.
Editor's Note: The procedure addressed security aspects of DC based IMS Avatar Communication on network centric rendering.
As stated in key issue #2 details, subscribers could use Avatars during their calls to other subscribers.
Avatars are expected to be identified by Avatar IDs and Avatar IDs are used for referring to the Avatar objects during IMS calls.
The originating IMS system checks whether the IMS subscription of the calling UE is authorized to use avatars and the Avatar ID..
The originating IMS system could also provide the callee IMS identity (Callee IMPU) for authorization purposes in Step 21.
If no Avatar object data exist for this subscriber (IMS identity), the rest of avatar related steps are not executed during the call set-up.
The O-STI-AS signs the SIP identity header according to STIR/SHAKEN framework and draft-ietf-stir-passport-rcd-26.6.
The originating IMS system routes the call to the egress IBCF.
Then the SIP INVITE is routed over the NNI through the standard inter-domain routing configuration.
The terminating service provider’s ingress IBCF receives the INVITE over the NNI and forwards to terminating IMS systems.
The terminating IMS system invokes the terminating STI-VS (T-STI-VS) to verify the signed SIP identity header.10.
The SIP INVITE with the verstat parameter is sent to terminating SIP UA.
The terminating IMS system could optionally send the avatar data to the terminating SIP UA.
The terminating SIP UA sends 18X and 200 to the terminating IMS system.
The T-STI-AS signs the SIP identity header according to STIR/SHAKEN framework and draft-ietf-stir-passport-rcd-26.16.
The terminating IMS system sends the 18X/200 message including the signed avatar object databack to the originating IMS system.
An avatar call is being initiated between the originating and terminating UEs.
A local policy on OAS can determine if the UEs can access the avatar objects once or multiple times.
The solution addressed KI#X security and privacy aspects of IMS DC capability exposure.
Solutions to support IMS event and capability exposure in the context of data channel (DC) communication/session are developed in TR 23.700-77.
NEF makes authorization decision and grants permission for the request based on the policies and user consent.5.
NEF receives event notification from DCSF.DC session control includes bootstrap and application DC establishment, update and termination, as well as DC application download.
NEF receives bootstrap data channel (BDC)/application DC (ADC) establishment/termination/update or application download request from DC AF/AS.
After authenticating the DC AF/AS (TLS based mutual authentication), NEF retrieves authorization policies locally or from HSS/UDM.NOTE 1: NEF 5.
DCSF triggers IMS AS to re-invite the IMS call to include DC offer with UEs, and reserve DC resource with MF if needed.7.
Editor's Note: The procedure of IMS DC capability exposure depends on SA2's conclusion.
Editor's Note: This clause contains the agreed conclusions that will form the basis for any normative work.