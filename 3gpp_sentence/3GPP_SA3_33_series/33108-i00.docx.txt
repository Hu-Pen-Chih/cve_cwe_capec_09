the third digit is incremented when editorial only changes have been incorporated in the document.
ITU-T Recommendation X.690: "ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)".
IETF RFC : "ISO Transport Service on top of TCP (ITOT)".
EN 300 356 (all parts): "Integrated Services Digital Network (ISDN); Signalling System No.7; ISDN User Part (ISUP) version 3 for the international interface".
NOTE 3: Referenceis specific, because ASN.1 parameter "release-Reason-Of-Intercepted-Call" has the following comment: "Release cause coded informat".
ITU-T Recommendation Q.931: "ISDN user-network interface layer 3 specification for basic call control".
IETF RFC : "Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO)".
IETF RFC :"The Extensible Markup Language (XML) Configuration Access Protocol (XCAP)".
IETF RFC : "Session Description Protocol".3: "Cx and Dx interfaces based on the Diameter protocol; Protocol details".
For the purposes of the present document, the terms and definitions given in TR 21.905and the following apply.
A service provider needs not necessarily run his own network.target identity: technical identity (e.g. the interception's target directory number), which uniquely identifies a target.
single target It 4.4.0 IntroductionFigure 4.1 shows a block diagram with the relevant entities for Lawful Interception.
The IIF provides the CC and the IRI, respectively, at the Internal Network Interface (INI).
As an option, IRI records can be aggregated for delivery to the same LEA (i.e. in a single delivery interaction).
The HI2 interface port the information or data associated with the communication services of the target identity apparent to the network.
The specified data communication methods provide a general means of data communication between the LEA and the operator's (NO/AN/SP) mediation function.
-7NOTE: TPKT/TCP/IP is recommended in the case of IRI only with the option of IRI Packet Header Information reporting.
The individual IRI parameters Where possible, the format of the information content IP).
If LI is being deactivated during an established PDP context or similar, no IRI-END record will be transmitted.
The Communication IDentifier is specified in the subsequent subclauses of 5.1.2.
Communication Identifier (CID)- Network IDentifier (NID);Intercepting Node ID is used for the NID in the UMTS system.
For the Communication IDentifier (CID) in the UMTS system we use the combination of Interception Node ID and the correlation number.
Optional parameters are provided depending on the availability at the MF.
For the internal structure of the IRI records, the ASN.1 description, with the application of the basic encoding rules (BER) is used.
Lawful Interception Identifier (LawfulInterceptionIdentifier, see clauses 5.1.1 and B.3a).Date & time of record trigger condition.
The parameter Normally, the operator (NO/AN/SP) Table 5.3 summarizes the items of HI2 control information.
This clause defines parameters within IRI records for basic calls, i.e. calls, for which during their progress no supplementary services have been invoked.
The structure of these containers and the representation of individual items are defined in clause B.3a.
If the same item appears identically several times during a call, it needs only to be transmitted once, e.g. in an IRI-BEGIN record.
The ASN.1 name of the respective parameters, as defined in clause B.3a, is indicated in brackets.
The LALS reports defined in TS 33.107are delivered via HI2, as well.
LALS Target Positioning REPORT RecordNOTE 2: See thefor a detailed description of LALS.
The LEMF constitutes an ISDN DSS1 user function, with an ISDN DSS1 basic or primary rate access.
Parameter 5 indicates in case of separate transmission of each communication direction, which part is carried by a CC link.
It is optionally used at set up the CC link to the LEA.
With the specified amount of services used for the CC links, this cannot happen.
See clause J.1 for the ASN.1 definition of the UUS1 LI specific content of the UUS1 parameter.
When using CLIP, the supplementary service CLIR has to not be used.
That is, these services have "no impact" on LI, no special functions for LI are required.
That is, these parameters are normally sent to the LEA, immediately when they are available from the protocol procedures of the service.
In many cases, additional IRI-CONTINUE records, compared to a basic call, will be generated.
However, not each service related signalling event needs to be sent immediately within an individual record.
With respect to the CC links, two options (A, B) exist, which depend on laws and regulations, see below.
The second CC link set, for the previously held call stays intact.
For the forwarded call the IRI-CONTINUE record is generated and sent to a LEA, indicating the CFNR invocation.
The CC-Link-Identifier is used when single circuit-link is used to deliver the CC of all call-legs of multi-party calls.
To the target: indicates that the voice content is sent to the target.- Unknown: indicates that the direction cannot be determined.
The intercepted voice-content delivered over HI3 is identified within the ASN.1 module as payload.
UMTS PS LALS reports are sent to the LEMF in the REPORT IRI records.
IRI is described in terms of a 'causing event' and information associated with that event.
Within each IRI Record there is a set of events and associated information elements to support the particular service.
This clause describes those events and supporting information.mandatory (M) - required for the record,optional (O) - provided at the discretion of the implementation.
The REPORT record is used to report non-communication related subscriber actions (events) and for reporting unsuccessful packet-mode communication attempts.
RecordTable 6.9I: LALS Enhanced Location for IRI REPORT RecordNOTE 1: See thefor a detailed description of LALS.
See Annex O for information on using of the PS ASN.1 information object for the LALS reporting.
When the IP-CAN is the UMTS PS domain, annexes C and G apply for CC interception at the SGSN/GGSN.
Unique identification of network operator, access network provider or service provider.
Two parameters are defined to enable further correlation than can be accomplished via a LIID alone.
The first is called a Correlation number while the second is simply called Correlation.
The Correlation Number was initially defined to carry a GPRS/EPS Correlation Number and is limited to those access types that support a PDP Context/EPS Bearer.
Subsequently, the Correlation parameter was defined to enable a more general correlation.
The value used in the Correlation number parameter or the Correlation parameter See clause 6.1.3 for a definition of the GPRS Correlation Number.
The CSCF - LIID;NOTE 2: The implementation dependent number a 'Call-id'.
However, when a CSCF acts as a back-to-back user agent a CSCF can have different 'Call-id' values for different legs of signalling.
Therefore some other number would be needed in such a case.
In these cases the LEMF receives encrypted CC and decrypts it based on the decryption information received over the HI2 interface.
If the warrant requires only signaling information, specific content in the parameter 'SIP message' like IMS (Immediate Messaging) has to be deleted/filtered.
IRI is described in terms of a 'causing event' and information associated with that event.
Within each IRI Record there is a set of events and associated information elements to support the particular service.
Each record described in this clause consists of a set of parameters.
Both optional and conditional parameters are considered to be OPTIONAL syntactically in ASN.1 Stage 3 descriptions.
OverviewFor the delivery of CC and IRI the PDG or AAA server provide correlation numbers and target identities to the HI2 and HI3.
The information is described as records and information carried by a record.
This clause describes those events and supporting information.mandatory (M) - required for the record,optional (O) - provided at the discretion of the implementation.
The mandatory or optionality of the parameters is not changed for I-WLAN.
OverviewThe MBMS LI solution in this section provides an IRI solution for MBMS only.
CC interception is provided by transport bearer level interception functionality e.g. GSNs.
The ability for multiple LEAs (up to five) to monitor, simultaneously, the same target while maintaining unobtrusiveness, including between agencies;9.5.0 General1.
As a minimum, IMPU and IMPI reporting support will be required.
The information is described as records and information carried by a record.
This clause describes those events and supporting information.mandatory (M) - required for the record,optional (O) - provided at the discretion of the implementation.
See Table 9.3- the target's MBMS UE or target via an off-line means (e.g. via internet or customer service centre) performs MBMS Subscription Termination.
The applicability of the events to specific access (E-UTRAN, trusted non-107 .
The records used transmit the information from mediation function to LEMF.
This set of information can be extended in the network nodes or DF2 MF, if this is necessary in a specific country.
The following table gives the mapping between information received per event and information sent in records.
The information is described as records and information carried by a record.
This clause describes those events and supporting information.mandatory (M) - required for the record,optional (O) - provided at the discretion of the implementation.
The REPORT record is used to report non-communication related target actions (events) and for reporting unsuccessful packet-mode communication attempts.
The packet data header information related REPORT record is used to convey packet header information during an active EPS bearer/session.
In case of handover between different accesses when GTP based messages are intercepted.
In this case, the RAT type indicates the new access after the handover.
For the delivery of CC and IRI, the AS/MRFC/MRFP provides correlation numbers and target identities to the HI2 and HI3.
The network identifier (NID) is a mandatory parameter; it It consists of the following two identifiers.
Unique identification of network operator, access network provider or service provider.
The QoS used from the operator (NO/AN/SP) to the LEMF is determined by what operators (NO/AN/SP) and law enforcement agree upon.
Basic data communication information, for standard data transmission between two parties.
According to each event, a Record is sent to the LEMF if this is required.
The records used transmit the information from mediation function to LEMF.
This set of information can be extended in the ICE or DF2 MF, if this is necessary in a specific country.
The following table gives the mapping between information received per event and information sent in records.
IRI is described in terms of a 'causing event' and information associated with that event.
Within each IRI record there is a set of events and associated information elements to support the particular service.
Each record described in this clause consists of a set of parameters.
Both optional and conditional parameters are considered to be OPTIONAL syntactically in ASN.1 Stage 3 descriptions.
This is needed to ensure that target identified in the lawful authorization is associated with the Public User Identity assigned to the user.
Also, some national regulations See clause 7.1.2.- Correlate CC with IRI,For IMS-based VoIP, the S-CSCF and optionally, the P-CSCF provide the IRI events.
The CC-Unavailable is reported only when the media interception is required according to the intercept order but the media is not available for interception.
In the alternate roaming architecture (Local Breakout), the PDN-GW and P-CSCF reside in the VPLMN.
As described in, the CC is generated by the PDN-GW or by the IMS-AGW and, for redirecting scenarios, by the IM-MGW or by the TrGW.
A condensed view of the same is presented in figure 12.1 below.
It The authorized CSP The network identifier (NID) is a mandatory parameter; it It consists of the following two identifiers.
Unique identification of network operator, access network provider or service provider.
At Discovery Request;The IRI may be subdivided into the following categories:2.
According to each event, a Record is sent to the LEMF if this is required.
The records are used to transmit the information from the mediation function to LEMF.
This set of information can be extended in the ICE or DF2 MF, if this is necessary in a specific country.
The following table gives the mapping between information received per event and information sent in records.
The information is described as records and information carried by a record.
This clause describes those events and supporting information.mandatory (M) - required for the record,optional (O) - provided at the discretion of the implementation.
The REPORT record is used to report non-communication related target actions (events).- The ProSe Function receives a Discovery Request from the UE.
When a ProSe Remote UE connects to or disconnects from a target ProSe UE-to-NW Relay;4.
When a target ProSe Remote UE ends communication by using a ProSe UE-to-NW Relay;6.
When interception is started for a Prose UE-to-NW Relay with connected ProSe Remote UE(s).1.
When a Tracking Area/EPS Location Update occurs for a target ProSe UE-to-NW Relay;3.
IRI is specified in terms of a 'causing event' and parameters associated with that event.
Within each IRI record there is a set of events and associated information elements to support the particular service.
Each record described in this clause consists of a set of parameters.
Both optional and conditional parameters are considered to be OPTIONAL syntactically in ASN.1 Stage 3 descriptions.
One or several UEs connect to or disconnect from a target ProSe UE-to-NW Relay.
A failure occurs when the target ProSe Remote UE attempts to start communication by connecting to a ProSe UE-to-NW Relay.
communication.- The target ProSe Remote UE starts communication by connecting to a ProSe UE-to-NW Relay.
The target ProSe Remote UE ends communication by disconnecting from a ProSe UE-to-NW Relay.
For the delivery of CC and IRI, the GCS AS provides correlation numbers and target identities to the HI2 and HI3.
The network identifier (NID) is a mandatory parameter; it It consists of the following two identifiers.
Unique identification of network operator, access network provider or service provider.
The QoS used from the operator (NO/AN/SP) to the LEMF is determined by what operators (NO/AN/SP) and law enforcement agree upon.
IRI is described in terms of a 'causing event' and information associated with that event.
Within each IRI record there is a set of events and associated information elements to support the particular service.
Each record described in this clause consists of a set of parameters.
Both optional and conditional parameters are considered to be OPTIONAL syntactically in ASN.1 Stage 3 descriptions.
The data structure also allows for the reporting of separate media streams for each user in the group communications.
A Report record The CC PDU contains the content of an MMS.
The MMS Proxy-Relay reports the IRI associated with the MMS services.
IRI is described in terms of a 'causing event' and information associated with that event.
Within each IRI record there is a set of events and associated information elements to support the particular service.
Each record described in this clause consists of a set of parameters.
Both optional and conditional parameters are considered to be OPTIONAL syntactically in ASN.1 Stage 3 descriptions.
The type of this IRI report shall use the IRI-Report-record17.1.0 IntroductionThis clause applies to the PTC services identified in Clause 21 of TS 33.107 .
When PTC events are detected the CSP TS 33.107defines the PTC events to be reported.
A set of information is used to generate the IRI records.
The records used transmit the information from mediation function to LEMF.
The following table gives the mapping between information received per event or report and information sent in records.
The PTC Start of Interception Begin Record is not reported for an Instant Personal Alert type of PTC Session.
In addition the PTC Access Policy Report Record PTC user access policy and PTC Group authorization rules).
The PTC Media Type Notification Continue Record video, images, text, and files) directed to/from the target's PTC client.
If rekeying is deployed, one or more new Encryption messages are sent coincident with the change in keys.
Annex A (normative):A.0 Introductiona) FTP.The present document recommends that option b) is used.
A.2 FTPAt HI2 interface FTP is used over internet protocol stack for the delivery of the IRI.
This alternative A is used when each target's IRI is gathered per observed target to dedicated delivery files.
The type "1" is reserved for IRI data files and type "8" is reserved for national use.
The FTP client can be implemented in many ways, and here the FTP usage is presented with an example only.
The FTP client can be implemented by a batch file or a file sender program that uses FTP via an API.
The login needs to occur only once per e.g. <destaddr> & <leauser> -pair.
The FTP server at LEMF The following implementation example addresses a particular issue of FTP implementation.
MF sends data with a filename, which indicates that the file is temporary.
Once data transfer is complete, MF renames temporary file into ordinary one (as defined in C.2.2).
A constructor type An IMPLICIT type is encoded with the constructor identifier alone.
Both ends of a communication have to understand the underlying structure of the IMPLICIT types.
EXPLICIT types are encoded with the identifiers of all the contained types.
The present document uses IMPLICIT tagging for more compact message encoding.
For North America, the use of J-STD-25 Ais recommended.UmtsCS-HI2Operations.asn which accompanies the present document.
The ASN.1 schema describing the structures used for EPS and IMS IRI (HI2 interface) is given in the file EpsHI2Operations.asn which accompanies the present document.
The ASN.1 schema describing the structures used for EPS CC (HI3 interface) is given in the file Eps-HI3-PS.asn which accompanies the present document.
Intercept related information (Conference Services)B.11.2 Contents of communication (HI3 IMS Conferencing)CONF-HI3-IMS.asn which accompanies the present document.
Intercept related information (HI2 MMS)B.16 Content information (HI3 MMS)B.17 IP based handover (HI3) for CS voice contentCSvoice-HI3-IP.asn which accompanies the present document.
Charging-ID is defined in TS 29.060and assigned uniquely to each PDP context activation on that GGSN (4 octets).
Therefore it is proposed to use the Charging-ID, defined in TS 29.060as part of correlation number.
Indicates whether the T-PDU was intercepted in the GGSN or in the SGSN: "0" indicating GGSN; and "1" indicating SGSN.
This parameter is needed only in case the GGSN and the SGSN use the same Delivery Function/Mediation Function for the delivery of Content of Communication.
This parameter is needed only in case several Core Network nodes use the same Delivery Function/Mediation Function for the delivery of Content of Communication.
The payload information element contains the header and the payload of the communication between the target and the other party.
C.2 FTPAt HI3 interface FTP is used over the internet protocol stack for the delivery of the result of interception.
The possible file type codings for intercepted data are shown in table C.1.
This alternative A is used when each target's intercepted data is gathered per observed target to dedicated delivery files.
Coding: "2" = CC(MO), "4" = CC(MT), "6" = CC(MO&MT), "8" = national use.
C.2.4 CC contents for FTPThe logical contents of the CC-header is described here.
The Information Element CorrelationNumber forms the means to correlate the IRI and CC of the communication session intercepted.
Subfield sizes: Type = 2 octets, Length = 2 octets and Value = 0…N octets.
TLV encoding:TLV encoding can always be applied in a nested fashion for structured values.
The MF and LEMF sides control the timers to ensure reliable, near-real time data transfer.
Guidance is given for client-server arrangements, session establishments, time outs, the handling of the files (in RAM or disk).
Example batch file is described for the case that the sending FTP client uses files.
The following implementation example addresses a particular issue of FTP implementation.
MF sends data with a filename, which indicates that the file is temporary.
Once data transfer is complete, MF renames temporary file into ordinary one (as defined in F.3.2.2).
The header contains general information like LIID, timestamp, correlation information (as for example defined in -1 ).
The payload contains content of communication based on information that the MF has received from sources in the network.
EN 300 061-1: "Integrated Services Digital Network (ISDN); Subaddressing (SUB) supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification".6.
Generic functional protocol for the support of supplementary services; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification".16.
EN 301 344, GSM 03.60: "Digital cellular telecommunications system (Phase 2+); GPRS Service description stage 2".22.
They could be used to correlate SIP messages with the PDP context(s) used.
The individual IRI parameters are coded using ASN.1 and the basic encoding rules (BER).
The individual IRI parameters are conveyed to the LEMF in "LI application" messages or IRI data records.
After the TCP connection has been established, the MF In all cases, LawfulIntercept messages are only sent from the MF to the LEMF.
All transfer of packets other than those operationally required to maintain the connection has to be from the MF to the LEMF only.
The maximum TPDU size to be supported is the default maximum TPDU size specified inand is not negotiated.
Consequently, the segmentation and reassembly procedures associated with TPKT will not be used.
G.3.1.1.3 Sending of Content of Communication MessagesIn all cases, CC messages are only sent from the MF to the LEMF.
All transfer of packets other than those operationally required to maintain the connection has to be from the MF to the LEMF only.
, the MF To protect against address spoofing and other security concerns, it is recommended that the MF and the LEMF utilize IPSec.
NOTE 3: DDR does not apply to PS domain and IMS-based multi-media services other than voice.
The coding of a subaddress information element is given in EN 300 403-1 .
A network provided number The length of the identifiers is variable.
Handling of sequence number is done according to national requirements.- From the Target.
The VoIP-CC-PDU includes both from the target and to the target.- National parameters (national-HI3-ASN1Parameters, optional).
The VoIP CC was intercepted at the GGSN.- IMS AGW (aGW).
The VoIP CC was intercepted at the IMS AGW.- IM-MGW (mGW).
The VoIP CC was intercepted at the IM-MGW.- Other nodes (other).
Conference HI3 InterfaceThe Conference CC Protocol Data Unit (Conf-CC-PDU) is delivered to the LEMF using UDP or TCP as the transport protocol.
The handling of Lawful Interception Identifier is done according to national requirements.- Time Stamp (timeStamp, optional).
The Conf-CC-PDU is sent towards the target from the conference mixer.- Conference target (conftarget).
The Conf-CC-PDU is sent towards the conference mixer.- National parameters (national-HI3-ASN1Parameters, optional)- Media ID (mediaID, optional)- ConfPartyInformation (sourceUserID, optional).
The ASN.1 schema describing the structures used for LI management notification operation (HI1 interface) is given in the file ThreeGPP-HI1NotificationOperations.asn which accompanies the present document.
N.1 IntroductionThis annex focuses on the correlation numbers used in IMS VoIP and IMS Conferencing.
N.2.0 GeneralIRI-to-IRI-Correlation contains the correlation number related to the IRI messages and the IRI-to-CC-Correlation contains correlation numbers related to the CC.
This annex assumes that a for a VoIP call, only one instance of cc within the ims-cc (i.e. IRI-to-CC-Correlation) is required.
All IRI messages will have the correlation number value of 100 and the associated CC will have use the same correlation number value of 100.
N.2.2 Multiple Correlation Number ValuesHere, the IMS nodes do not exchange the correlation number values.
In this case, correlation numbers The Table N-3, Table N-4 and Table N-5 illustrate the usages.
P-CSCF tells the IMS-AGW to use the correlation number value of 250 and S-CSCF uses the value of 100 for IRI.
N.2.2.3 Method 3In Table N-3, the values of 100, 200 and 250 are used as the correlation number values.
The IRI messages will have the correlation number value of 100, 200 and the associated CC will have use the correlation number value of 250.
This is illustrated in Figure N-6.In Table N-6, correlation number value 100 is used.
In the example, two sets of {ims-iri, ims-cc} and only one set of {cc} within each of the ims-cc is used.
Here, the IMS nodes do not exchange the correlation number information.
N.2.4.1 Method 1In Table N-7, the values of 100, 250, and are used as the correlation number values.
The IRI messages will have the correlation number value of 100 and .
The associated CC will have the correlation number values 250 and .
In this example, there are two sets of {ims-iri, ims-cc} and there is only one set of {cc} within the ims-cc.
Complex Example to show the use of IMS-VoIP-CorrelationIn Table N-8, the values of 100, 200, 250, and are used as the correlation number values.
In this example, there are two sets of {ims-iri, ims-cc} and there is only one set of {cc} within the ims-cc.
For this, either the choice of correlationNumber or the choice of imsVoIP can be used.