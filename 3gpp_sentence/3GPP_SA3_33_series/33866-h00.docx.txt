This key issue studies the integrity aspects on data collection and utilization of UE data in order to derive the analytics.
Based on a request from a DCCF data received from a data producer is stored in the DRF.
MFAF and its services i.e., Nmfaf_3caDataManagement Service and Nmfaf_3daDataManagement Service to interact with the messaging framework are defined in .
Note 1: Description of the attacker model is not addressed in the present document.
The transfer of any data between core network functions needs to be protected.
If data is transferred between NFs or different NWDAF Instances, a MitM (for instance a malicious SCP) can compromise data by eavesdropping or modification.
Therefore, this key issue will study how to ensure that trained model sharing is only allowed among authorized NWDAF instances.
Only authorized NWDAF instances Table 6.0-1: Mapping of solutions to key issuesThis solution addresses KI#1.5 on UE data collection protection at NF/NWDAF.
FS_UC3S.This solution reuse the existing 5GS security mechanisms, include the current NAS and AS security mechanisms to solve the security problems between UE and network..
This solution meets the requirement in KI#1.5 without any extra system impact.
Service data related to UE mobility provided by AF, including: UE ID, Application ID, UE location, Timestamp.
The NWDAF could output the following: Exception ID, Exception Level, Exception trend, UE characteristics, SUPI list (1..SUPImax), Ratio, Amount, Additional measurement, Confidence.
Specifically, exception ID can be "Suspicion of DDoS attack" means that the UE In this case, Additional measurement is "Victim's address (target IP address list)".
In column DDoS attack, target network entity and attack method are clarified.
In column analysis, input, output and mitigation are listed as the same way as.
According to, clause 13.3.0, all network functions support mutually authenticated TLS and HTTPS.
TLS is used for transport protection within a PLMN unless network security is provided by other means.
This solution addresses the requirement of key issue #3.2.This solution provides mutual authentication, confidentiality, integrity and replay protection between NFs as described in.
The NRF determines if the NF Service Consumer is authorized to use the service of the Service Producer and provides an authorization token.
NOTE 1: It is assumed that the NF Service Consumer relies on the DCCF to determine the Data Producer NFs for data collection.
An NF service consumer (e.g. NWDAF) discovers a DCCF to retrieve data.
The access token (access_token_nwdaf) is provided to the NF service consumer.
The NF Service Consumer initiates an NF service request to the DCCF which includes the access_token_nwdaf.
The DCCF determines that the requested service is provided by a different NF Service Producer(s).
The DCCF uses the access token to initiate an NF service to the identified NF Service Producer to retrieve the data.
The NF Service Producer(s) provide requested data in the response to step 10.The data consumer is authorized to access the data from the data source.
This solution addresses KI#1.4 on the security of data via Messaging Framework.
For the same type of data collection, the DCCF can manage an encryption key and an integrity key.
The DCCF provides the keys to the data consumer and the data producer.
In such way, the data will not be revealed to the Messaging Framework and any modification of the data can be detected.
Data Specification provides Service_Operation-specific required parameters (e.g. event IDs, UE-ID(s), target of event reporting) and optional input parameters used to retrieve the data.
The DCCF determines the Data Source (e.g. AMF-1) that can provide the data and checks that the requested data is not already being collected.
The data source encrypts the data using KE and protects the integrity of the data by including a MIC (Message Integrity Code).
The data source computes the MIC as HASH KI (data || Sequence Number).The message also includes the Sequence number received in step 7.10.
The DCCF determines that the requested data is already being collected from a Data Source (e.g.: AMF-1).10b-12.
the DCCF provides the key KE and key KI, it also maintains a timer for renewing the keys.
When the DCCF sends the new keys to the data consumer, it put the Subscription ID mentioned in step 6 in the message.
The DRF then can decrypt the encrypted data and store it unencrypted in the DRF (tamperproof) memory.
Such anomalous behaviour can arise either due to configuration errors or internal data corruption, or due to an attack.
In order to analyse the root cause of the anomaly with certain degree of confidence, more information or related data can help.
Thus, NWDAF requests inputs from different entities in the system (such as OAM, NRF and NFs) for detailed analysis.
Security related data for analytics can also be collected by NWDAF from the NFs (or via OAM).
The final output analytics is then sent to the OAM or the AF for adequate measures.
The OAM or operator's AF sends a request/subscription to the NWDAF for NF anomalous behaviour analytics using either the Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation.3a.
The NWDAF derives the relevant analytics using the inputs provided by the OAM, NRF, and the NF (as specified in the table 6.7.2.3-2)2.
A heartbeat message is sent by NFs every some seconds (i.e. 10-20 seconds).
Therefore whenever the privacy rule is changed in the NRF, the NRF can push updated rules to the NFs.
NOTE 1: DataPurposeID specifies the purpose of the user data request corresponding to an analytics ID.
Step 2: NWDAF2 sends a request to retrieve the user privacy policies for a specific subscriber from the UDM/UDR.
Or it can use the locally configured policies based upon the operator's or geographical requirements.
Step 4: NWDAF2, after receiving the policies, applies them to the requested user data for the DataPurposeID.
For instance, because of the privacy policy it can either reject the request completely or it sends the data without or with anonymization.
Policies received in Step 0 are also applied along with policy received in Step 3.
Note 3: Not addressed in the present document "DataPurposeID" in relation with privacy.
Step 5: NWDAF2 sends the processed data to NWDAF1 as a response to the initial request.
Data consumer requests analytics service from any analytics function, e.g. NWDAF.
The Data Sanitation NF forwards the data request to the data provider and subscribe to the respective data.
The data provider then sends the data to the Data Sanitation NF.
The sanitization NF receives the data, identifies the sanitization policy, and then processes the data according the policy defined.
The analytics function sends the subscribed analytics to the NF Service Consumer using the sanitized data.
Similarly, DCCF accesses the services of MFAF (if the notification is sent via MFAF) using the existing SBI mechanisms.
The service request to access the DCCF by NF Service Consumer also contains the Client Credentials Assertion (CCA) token (CCA_NWDAF) as described in TS 33.501.
DCCF now further requests the NRF to provide an access token to access services on behalf of the NF Service Consumer.
The NRF verifies the information provided by the NF Service Consumer and generates an access token as described in TS 33.501.6.
The DCCF determines the NF Service Producer(s) from where the data is to be collected.7.
The NF Service Producer(s) authenticate the NF Service Consumer and verify the access token as specified in .
The NRF verifies the information provided by the NF Service Consumer and generates an access token as described in TS 33.501.6.
DCCF then requests NRF to obtain an access token to consume the services of MFAF in order to send configuration request to MFAF.
The NRF after verifying provides an access token (access_token_dccf) as a response.
DCCF then sends a configuration request as specified inclause 6.2.6.3.4 to MFAF (along with access_token_dccf).
The MFAF then verifies the access_token_dccf and in case of successful verification, services the request.
The NF Service Producer(s) provide requested data to MFAF as notification.
A DCCF could subscribe for data from the data source on behalf of the data consumer without the data consumer authorizing DCCF to do so.
Authorization of the DCCF is supported to access a service of a data source on behalf of a data consumer.
NF Service Producer (data producer) sends the data to ADRF (directly or via DCCF) and Step 2.
NOTE 1: Steps 1-2 ensure that the NF Service Producer information from which the data was collected is present in the ADRF.
If the information is already present, Steps 1-2 are not needed, and the procedure defined in Clause 6.2.6.3.3 inis followed.
DCCF forwards the historical data request to ADRF along with the access token received.
ADRF now authenticates the NF Service Consumer via the CCA provided and performs two verifications.
The request also contains the access token to request services from DCCF and CCA of NF Service Consumer.
DCCF forwards the historical data request to ADRF along with the access token received.
DCCF also configures the MFAF to forward the data to the data consumerStep 7.
First, it checks if an audience claim is matching its own NF type (or NF Instance ID).
Based on a request from a DCCF data received from a data producer is stored in the ADRF.
Authorization of the DCCFis supported to access a service of a data source on behalf of a data consumer.
This solution addresses the unauthorized data consumer issue in the case that DCCF is used to coordinate the data collection.
The solution is shown in detail below: Figure 6.12.2-1: Authorization of data consumer for services of DCCF and data producer2.
The NRF checks if the data consumer is allowed to access DCCF.
The access token that the consumer receives from the NRF contains the information that the consumer is authorized to invoke DCCF services.
The NRF sends the token for the DCCF service to the data consumer.5.
The NRF checks if the data consumer is allowed to consume the data.
The access token that the consumer receives from the NRF contains the information that which data the consumer is allowed to retrieve.
The NRF sends the token for data collection to the data consumer.8.
If the consumer is allowed to get services from the DCCF and collect data, then the DCCF coordinates the data collection request.
DCCF requests an access token for itself from the NRF to get the service from data producer.
NRF provides an access token for the service of data producer to the DCCF.11.
This solution solves the key issue #1.5, UE data collection at NF/NWDAF.
Solution detailsExisting primary authentication inis used to authenticate UE and network.
The communication between UE and network Existing AS and NAS security mechanism inis used to provide the required integrity.
Introduction This contribution proposes a solution to key issue #3.3, Ensuring restrictive transfer of ML models between authorized NWDAF instances.
If the check fails, then the service consumer NWDAF is denied of the requested service.