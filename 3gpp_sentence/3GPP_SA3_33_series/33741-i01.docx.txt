The present document studies the use cases which needs Home Network initiated primary authentication and the associated security threats and requirements.
All the solutions will be evaluated specific to the use case in the Annex A of the present document.
And these multiple primary authentications obviously lead to signaling overhead and cause a refresh of the entire key hierarchy impacting both core and access security.
The UDM decides to perform the UE parameter update procedure or SoR procedure.
AF and the AF wants to refresh the KAF via 5GC, the AF request AAnF for UE re-authentication so that KAF can be refreshed.
If the interval is 30 minutes or more, then AAnF invokes the UDM service/API to start the primary re-authentication.
Alternatively, "wait time before initiating new re-authentication" can be maintained at the UDM as well.
The UDM authorizes the request based on existing means (e.g. Oauth2.0).The solution fulfils the requirements defined in KI#1 and related 3 use-cases.
The solution introduces a new service exhibited by the AMF and to be used only by the UDM to request primary authentication.
Upon a request from the UDM, the AMF triggers primary authentication using the existing services and NAS procedures.1.
The AUSF and the AAnF sends Nudm_HNAuthenticate-Request message to the AMF for this purpose.
Then the UDM selects the AMF that is serving the UE from the UE context.
The UDM sends Namf_HNAuthentication_Request message to the AMF the message contains the SUPI of the UE.2.
The AMF provides Home Network Authentication service to the requester NF, i.e. UDM, by Namf_HN Authentication.
NOTE 1: No AMF's reaction on this error code in stage 3.
The reaction of AMF to the error information from the UDM need to be clarified in, and align with.
Normative work is needed for this use case to guarantee the trigger of authentication in the AMF side.
This solution addresses KI#1 and relates to the LTE-5G interworking case.
NOTE 2: The AKMA function could request a trigger of authentication to refresh the AKMA key.
It is also left to the UDM implementation whether to try the second AMF if the request to the first one fails.
Step 4: If the UDM triggered the authentication due to a request from an NF, then the UDM responds to the NF with an acknowledgement.
Solution #5 requires two new pieces of functionality:Running all the requests through the UDM allows one entity to control the number of authentications runs triggered.
AUSF sends a re-authentication request to the UDM by providing SUPI of the UE. 4.
Operator policy includes the details of the wait period for the new request, after the last successful authentication.
If the operator policy allows, then the UDM requests the AMF currently serving the UE to initiate the primary authentication for the UE.
This solution proposes a mechanism for the UDM to trigger a primary authentication.
The use case on long lived KAUSF is not specified in the present document.
This solution describes how the UDM initiates a primary authentication to refresh the long lived key KAUSF.
By performing the re-authentication procedure, a new KAKMA can be derived by the new generated KAUSF1.
Same as the Nudm_UECM_DeregistrationNotification service, the UDM provides the reason for sending the re-authentication notification to the consumer NF.
If the UDM has requested an acknowledgement from the AMF, the AMF returns the Re-Authentication Notification ACK message to the UDM.4.
The Nudm_UEAuthentication_Get Request sent from AUSF to UDM includes SUPI and the serving network name.
The AUSF The AUSF also resets the CounterSoR/CounterUPU once the new KAUSF is generated.8.
The expiration time for the primary authentication related to the SUPI can be set in the UDM based on local policy.
The UDM can send an acknowledgement indication in the notification response message.
Based on the selected authentication method, generate the authentication vector (AV) as in TS 33.501clause 6.1.3.
Setting of AKMA key expiry based on operator policy allows, the AAnF to set AF key expiry time same as AKMA key expiry.
So, before an AF key expire, the home operator would have performed a home triggered primary authentication based on operator policy.
Following a successful AF key establishment, the UE can securely communicate with the AF and use the application.
The waiting time(r) can be used by the AF to retry the key request procedure with AAnF.
During this time, the already running primary (re-)authentication if succeed, results in a new AKMA key and new AF key establishment.
A new primary authentication In such scenarios, an internal Network Function (AUSF) requests the AMF to trigger the re-authentication procedure.
The AMF initiates re-authentication of the UE, if an internal NF requests (AUSF) to initiate re-authentication to refresh the UE specific home key (KAUSF).4.
Upon receiving the request for the details of the current serving AMF from the AUSF, UDM provides UE's current AMF details in Nudm_UECM_Get response message.
The AUSF requests the AMF to initiate primary authentication for the UE by invoking Namf_UEAuthentication_Authenticate service operation as defined in clause 5.9.2.2.
Upon receiving the re-authentication message from UDM, the AMF acknowledges the request.1.
The UE initiates registration by sending a Mobility Registration Update message to the VPLMN AMF.3.
UDM sends a notification Nudm_UECM_Registration Response to the AMF with the "Reauthentication Required' indication set to true.
Upon receipt of the Nudm_UECM_Registration Response notification in 5, the AMF 5.9.2.2 Namf_UEAuthentication_AuthenticateDescription: The AUSF triggers the Re-authentication procedure.
A new service operation is introduced and whether the existing proposed procedure is sufficient will be discussed in normative work.
This solution addresses key issues #1 for KAKMA the refresh use case and key issues #2.
The AF selects the AAnF according to TS 33.535clause 6.7 using the A-KID associated with the expired KAF.
The Registration procedure as in TS 23.502 , clause 4.2.2.2.2, steps 1-13.
During UE registration in AMF, the AMF triggers Nudm_UECM_Registration service operation to register the UE in the UDM.
The UDM checks the authentication status and decides based on a HN primary authentication configuration to request a new primary authentication for the UE.
The Registration procedure as in TS 23.502 , clause 4.2.2.2.2, steps 14b-25.
See clause 5.11.2.4.1 for more details on how this procedure can be applied to cover the interworking use case.
The AMF potentially has authenticated the UE or has reused an authentication context from another AMF (or MME).
The UDM keeps a time stamp of the latest UE authentication in 5GC (refer to TS 33.501clause 6.1.4).
The UDM decides that the UE needs to be authenticated according to the HN primary authentication configuration.
See clause 5.11.2.4.2 for more details on how this procedure can be applied to cover the SoR/UPU wrap-up use case.
See clause 5.11.2.4.3 for more details on how this procedure can be applied to cover the KAF refresh use case.
Before acknowledging the Re-Authentication notification, the AMF first checks if the UE can be contacted to execute the requested primary authentication procedure.
It can be observed that interworking mobility from EPS to 5GS could result from a handover.
The UDM can detect that the SoR/UPU Counters has wrapped-up or are about to wrap-up during the execution of the corresponding services in AUSF.
The UDM receives the value of the Counters from AUSF so UDM can detect when the Counter are about to wrap up.
Ultimately, the AUSF provides a Counter wrap up error to UDM when the counters wrap up.
The solution addresses all the HONTRA use cases namely Interworking from EPS to 5GS, SoR/UPU counter wrap-around and AKMA KAF refresh.
The solution addresses the interworking use case by proposing to follow the Nudm_UECM_Registration procedure and the error code that the UDM sends to the AMF.
These The exact design of the HN primary authentication policy is left to normative work.
There are at least two options for the HN primary authentication policy.
Alternatively, this solution proposes that the HN provides the HN primary authentication policy to the SN via an online method using SBA interactions.
As Subscription Data provided to the AMF during registration (Nudm_SDM_Get Response).
However, there is no mechanism to refresh the counters unless by running the primary authentication.
If the KAKMA can be refreshed, then the issue is solved.
However, the AKMA feature specified in TS 33.535does not support refresh of the KAKMA key.
By triggering the primary authentication from the home network, the AUSF will generate a new KAUSF and a new KAKMA.