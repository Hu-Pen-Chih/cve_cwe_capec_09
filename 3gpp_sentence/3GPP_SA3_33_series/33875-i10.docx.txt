While the SBA provides a good level of security, several additional aspects have been identified that This will be documented by the present document.
For the purposes of the present document, the abbreviations given in TR 21.905andand the following apply.
An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905and.
NRF receives discovery requests from NF instances, maintains NF profiles and acts as an OAuth 2.0 authorization server.
Thus, securing at transport layer provides hop-by-hop security between two SEPPs.
Since there exist also deployments where intermediaries need to see or modify messages, PRINS was designed.
The trust relationships described here can be replaced by security mechanisms.
Whether the list of existing trust relationships described below is complete, depends on deployment choices.
Registration Management: An NF Service Provider needs to trust the NRF that no other NF can register its service profile with the identity of NFp.
If there is no direct communication between NF and NRF, an NF Service Provider needs to trust that the SCPs forward NFp profiles unmodified.
Discovery: An NF Service Consumer needs to trust NRF to provide profiles of authenticated NF Service Providers that offer their services to the requesting consumer.
Trust in direct communication between NFs, NFs and SCP/SEPP, as well as SCP and SEPP is assumed perwith mandatory mutual authentication using TLS.
For both standalone and service-mesh, the NFs sending their service requests via an SCP need to trust the SCP which handles their service requests.
A SCP domain comprises a configured group of one or multiple SCPs that can reach certain NF instances or SCPs directly.
The figure below gives an idea of structuring or grouping a PLMN in several SCP domains, possibly interconnecting with other SCP domains via dedicated SCPs.
Sensitive information in the notification could be disclosed to an unauthorized entity.
A SMF instance can wish to remain the SMF (binding to itself), but at end of procedure, i.e., non-moving UEs anymore foreseen.
Thus, this SMF gets stateless because it considers it is a long time before next SMF involvement.
But the requesting NF Service Consumer is not necessarily known to this OAuth authorization server in deployment scenarios with multiple NRFs.
There can be centralized NRF(s) or distributed NRFs in OAuth 2.0 Authorization Server role.
A malicious entity (for instance a NF Service Consumer) can request an access token for the slice it is not authorized to access.
The 5GS The 5GS In roaming scenarios, the communication between the visited network and the home network is sometimes mediated and routed through intermediaries.
By contracting the roaming hub, the operator obtains access to a large roaming footprint, without individually contracting the operators that are mediated through the hub.
Apart from mediating the signalling, roaming hubs typically also mediate the billing.
The GSMA is working on best practice guidance and related specifications for how operators interact with both IPX and roaming hubs.
However, the pre-5G architecture of these methods uses the LTE hop-by-hop security paradigm.
In certain scenarios, IPX providers and roaming hubs would need to modify certain IEs.
This requires the setup of appropriate modification policies between the roaming partners.
Furthermore, the NF profile is provided by the NF itself, which makes it a less reliable source for deciding whether the NF is authorized.
The SEPP is outsourced by the PLMN and hosted by an external entity and deployed outside the PLMN.
Figure 5.12.1-3 Hosted SEPP deploymentIn a Hosted SEPP scenario it is necessary to consider different perspectives when assessing the security perimeter boundaries.
From the roaming partners' perspective, the security perimeter of the PLMN extends to the Hosted SEPP provider, as described in , clause 4.2.1.
From the perspective of the PLMN itself, the Hosted SEPP provider operates within its own security domain.
Providing filtering criteria and capabilities – N32 side - Filtering criteria and possibly a firewall – Home PMN side.
In addition, the connection between Hosted SEPP and the Home PMN needs protection, e.g., Topology Hiding, filtering criteria and firewall, etc.
If indicated by NFc in the service request, the NFp provides back its CCA_NFp.
Thus, the NFc can compare the NFp instance ID in the CCA_NFp with the selected NF instance ID when NFc requested the service.
Since NFp provides its CCA_NFp, this comparison is even possible if the response is sent via SCP.In the following, the steps are described in detail.
Figure 6.1.2-2: Flow chart for allowing verification of NF sending the service responseStep 3: SCP intends to forward the service request to further SCPs.
If SCP or some proxy is malicious (or MitM), it forwards the service request to a rouge NFp instead.
Step 6: SCP will relay back the response to NFc including the CCA_NFp.
Step 8: If it does not match, the NFc can also raise an alarm and revert the transaction at NFc.
This solution introduces Client credentials assertion of NF Service Producer which includes NFp Instance ID and signature using certificate of NFp.
IntroductionWhen sending the service request to SCP in delegated discovery, the NF Service Consumer needs to authorize the SCP to act on its behalf.
The SCP includes the CCA received by the consumer in step 1.
The NRF verifies the CCA as described in clause 13.3.8.3 ofand thus obtains the NF Instance ID of the consumer that signed the CCA.
Besides authentication of the consumer, the CCA also implicitly authorizes the SCP to act on behalf of the NF Service Consumer.
The NF Service Producer validates the access token as described in.
Hence the access token does not only authorize the consumer, but also implicitly authorizes the SCP to act on behalf of the NF Service Consumer.
Although CCAs are expected to be short-lived, they could be cached for a short period of time at the NF Service Consumer.
The solution relies on token-based authorization and CCAs as currently specified in.
No e2e authorization information is provided from the NFc to NRF or NFp.
Thus, in this case the NRF or the NFp can provide the service response to an unauthorized consumer.
I.e., the NF Service Producer verifies that the data included in the payload is matching the service request received together with the CCA.
The receiver also verifies that the headers in the protected header list are not modified.
It also verifies that the headers in the protected HL are not modified.
A Rel-16 NF Service Producer will verify the signature of the CCA correctly but ignore the optional field that it does not recognize.
Similar behavior can be specified for IEs in the CCA, see Table 6.5.2-1 below.2.
NF Service Producer or NRF validates the CCA as described in, clause 13.3.8.3.
Note that the FC value will be allocated in the normative phase.
In order to verify the message from NF Service Producer in indirect communication, it is proposed to append CCA of NFp.
When receiving a Service Response, the NF Service Consumer 6.6.2.2 For indirect communication with delegated discovery Figure 6.6.2.2-1: for indirect communication with delegated discovery2.
The NRF authenticates the NF Service Consumer using one of the methods described in clause 13.3.1.2.
The NRF uses the NF Service Consumer instance ID as the subject of the access token.
The NRF sends the access token to the SCP in an access token response (Nnrf_AccessToken_Get Response).7.
and if successful, it validates the access token as described in clause 13.4.1.1. 8.
This solution works with assumption that the discovery results from NRF to NF Service Consumer are protected to detect any harmful modification in the middle.
Thus, verification of the correctness of a set id is done when authenticating the NF Service Consumer as OAuth 2.0 client when registering at NRF.
Using the same access token for a NF Service Consumers belonging to one NF Set is not explicitly described by RFC .
This solution addresses key issue #5.In the enhanced CCA, hash value of HTTP headers and hash value of HTTP body are included, separately.
There HTTP standard headers come first and HTTP custom headers come after HTTP standard headers.
This solution provides how to calculate hash value of HTTP headers and HTTP body even though SCP modify HTTP messages in NF Service Producer.
And when SCP modifies illegally a HTTP message, NF Service Producer can detect it.6.9.1 Introduction1.
The NF Service Consumer sends a discovery request to the vNRF.4-5.
This solution addresses the threats and requirements of Key issue #7: "Authorization mechanism negotiation".
This solution addresses for the inter-PLMN scenario the use case that the vPLMN has only implemented static authorization.
The NF Service Producer needs to support whichever authorization mechanism is determined by the hNRF, i.e., using different authorization mechanisms depending on the roaming partner.
It provides clarification of handling access token requests in different NRF deployment scenarios.
It is applied to an optimization in TS 23.501on a slicing-related procedure.
These attributes can then be used by NRF to determine the "producerSnssaiList" to be included in the AccessTokenClaims.
The NRF verifies whether the notification URI is authorized to receive the service/notification that is requested in the access token request.
Upon successful verification, the NRF publishes an access token for a Service Request of the NF_A toward the NF_B.
The access token includes notification URI of the NF_C in the claims as requested in step 2.Step 5.
Solution detailsWhen a re-selection of an NF Service Producer is performed, this procedure can be re-performed against the newly selected NF Service Producer.
Figure 6.13.2-1: Authentication Procedure for NF Service Producer in Indirect CommunicationThis solution allows a NF Service Consumer to identify the NRF or NF Service Producer.
A NF Service Producer can register within its profile its SCP domain.
Such technical SCP trust domains can be defined in large PLMNs, for example, based on computer centre boundaries, operators of subnetworks, regions/provinces, etc.
A SCP trust domain could be isolated from other SCP domains.
It could be registered or configured together with a set of policies at NRF.
A service is provided only for NFs of a distinct NF Type within a specific SCP trust domain.
The access from NF or SCP to the SCPs of a SCP trust domain can be limited to this domain only.
The Figure 6.15.2-1 describes the detailed solution for authorization mechanism for the involved NFs in the delegated "Subscribe-Notify" scenarios.
It allows an NF to verify the integrity of selected attributes in a service request or response consumer.
The solution does not propose any change to CCA or SCA.
For example, AUSF and UDM Local security policy can be dynamically updated as with other local configuration of the NFs.
NF Service Consumer and NF Service Producer can also communicate its security policy to each other.
NF Service Consumer can send its security policy to the NF Service Producer in its service request.
JWT tokens for the information elements in a service request or service response that require integrity protection.
The JWT token is digitally signed by the private key of the NF.
If yes, it extracts and verifies the JWT token to ensure that protected information elements have not been tampered with.
It is proposed to use the two NRFs for the authorization mechanism negotiation.
The solution assumes that discovery is used by both PLMNs according to the standard.
For inter-PLMN stage 3 (Table 6.1.6.2.3-1) "oauth2Required" can be used to handle the authorization method setting by the hNRF.
How to configure the NF profile in case the operator wants to change to another authorization method is out of scope of this solution.
Several means to allow a PLMN's hNRF to provide to the requesting vNRF information on the authorization method used exist in the current specification.
If in the array(PlmanId) of hPLMN NRF a roaming partner is on the "oauth2NotRequiredPlmnIdList", static authorization can be used with this roaming partner.
When operators follow the recommendations given in NG.113 , the key issue seems to be covered sufficiently by the existing methods.
Specification text is proposed as follows:The text proposed provides input to normative work on this topic.
IntroductionThere The roaming hubs require the ability to allow roaming relations between these PMNs via these roaming hubs.
The cSEPP then sends a CONNECT command to RH1's proxy indicating the destination to be pSEPP.
R1's proxy then sends a CONNECT command to RH2's proxy indicating the destination to be pSEPP.
RH2's proxy If not, the flow continues with the error message of step 5.
The RH The solution allows a RH to allow or deny roaming traffic between operators based on the contractual relations with the RH.
IntroductionThe authorization of a NF Service Consumer needs to be performed by validating verified information about the NF Service Consumer stored in NRF.
This solution proposes that the NRF validates NF Type, NF Instance ID, PLMN-ID, and FQDN.
It could either be mandated in the specification or required to be present in deployments in order for this procedure to work.
This potential solution addresses the KI #11, NRF validation of NFc for access token requests.
Having the NF instance ID present in the certificate can be reached in different ways.
It could either be mandated in the specification or required to be present in deployments in order for this procedure to work.
If it is not mandated that the information is present in the certificates, this 1.
The NRF retrieves the available NF Service Consumer information in the public key certificate of the NF Service Consumer.
NRF can also verify by CCA_NFc, if the SCP is listed in the NFc profile as being allowed to act on behalf of NFc.
When the NRF/NFp receives the request from a SCP, they compare the CCA 'serviceRequestInfo' parameter against the request which they have received.
This solution addresses the threats and requirements of Key issue #7: "Authorization mechanism negotiation".
This solution addresses the inter-PLMN scenario where the vPLMN has only implemented static authorization.
If PRINS with "full PRINS" is chosen, configuration parameters can still be negotiated/exchanged, which keeps market open to those, really wanting this high security optionb.
A data-type encryption policy indicates which types of data will be encrypted by the sending SEPP.d.
A PRINS profile indicating a predefined set of one or more of the above policies.
Evaluation for this solution is not addressed in the present document.
Evaluation for this solution is not addressed in the present document.
To fulfil the isolation requirement, the Hosted SEPP provider operates a dedicated SEPP instance for each PLMN it serves.
This includes the usage, for each customer PLMN, of at least one separate N32c (and N32f) connection(s) towards the roaming partners.
That is, it is prohibited to mix the signalling of multiple customer PLMNs over a single N32 connection due to the isolation requirement.
However, it also needs to be considered that reselection of the NF Service Producer by the SCP can be a desired feature.
Such a token is introduced to allow a client to validate the sender of a response directly, even if an SCP is in between.
Solution #1 has a limited scope as provided in the respective evaluation part in clause 6.1.
It does not address Model D or Model C without direct TLS between NF Service Consumer and NRF for discovery.
It requires that the NF Service Consumer has knowledge about which NF Service Producers are in the NF Set of the producer.
Thus, CCA validity time need to be chosen very carefully to minimize this possibility.
A third solution (Sol#23) proposes that NRF has in its database knowledge about the SCPs that could request a service on behalf of a consumer.
NRF needs to trust that any request forwarded by SCP was initiated by a NFc.
In summary, it is a trade of between security enhancement versus complexity added.
Only afterwards it can forward the access token request to the target NRF.
The parameter "allowedOperationsPerSnssai" allows finer control of scopes allowed to a consumer from a different slice.
In the problem statement it was asked whether one takes precedence over the other.
Regarding problem 2Solution summary Solution #21 proposes that NRF uses the information in the NF Service Consumer's certificate to base its authorization decision on.
In indirect communication the certificate is used by SCP for authentication.
NRF can either trust SCP authentication or use CCA for validation.
If information elements are part of both, certificate or CCA and in the request, they need to match.
It is therefore decided to outsource this key issue to a dedicated study on N32 roaming topics.