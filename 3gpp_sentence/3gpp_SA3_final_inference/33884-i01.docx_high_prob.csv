File Name,Sentence,Mapped CWE-ID,CWE Description,Positive Probability
33884-i01.docx.txt,"IETF RFC : ""Proof Key for Code Exchange by OAuth Public Clients"".",94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9976361989974976
33884-i01.docx.txt,NOTE 2: How the Resource owner is authenticated to the authorization server is out of scope of this solution.,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",0.9976254105567932
33884-i01.docx.txt,The architecture is derived from solution 2 in TR 23.700-95 .,94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9976432919502258
33884-i01.docx.txt,"In this solution, the API invoker endorses the role of client, the triggerer endorses the role of user-agent.",79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.9976596832275391
33884-i01.docx.txt,"The Authorization Function authenticates the resource owner in step B, which depends on existing mechanism and is out of this solution.",1333,"The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles.",0.9973155856132507
33884-i01.docx.txt,The API invoker (i.e. client) retrieves tokenCAPIF from the Authorization function in CCF.,425,"The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",0.9976250529289246
33884-i01.docx.txt,This solution separates these roles into the authorization function (AZF) and the authentication function (ANF).,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976660013198853
33884-i01.docx.txt,The Token Request includes the authentication of the API Invoker using the API invoker's client credentials.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976606369018555
33884-i01.docx.txt,The circumstance that the API invoker is located and associated with a UE can be exploited for instance by using AKMA3.,209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9975475668907166
33884-i01.docx.txt,The authorization server is authorizing the request based on the identity of the API Invoker and the requested scope by applying stored policies and permissions.4.,276,"During installation, installed file permissions are set to allow anyone to modify those files.",0.9976428151130676
33884-i01.docx.txt,In case of successful authorization the authorization server returns the token to the API invoker.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976487755775452
33884-i01.docx.txt,"The token includes claims, which reflect the granted scopes and permissions.",613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976385831832886
33884-i01.docx.txt,NOTE 3: The authorization server knows the identity of the UE from the UE authentication executed in step 2.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976490139961243
33884-i01.docx.txt,The API invoker is sending the actual API request to the AEF.,918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9976523518562317
33884-i01.docx.txt,The API request contains the token received in the previous step.,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976353645324707
33884-i01.docx.txt,As part of the session establishment the API invoker authenticates the AEF by verifying the Authorization Server's server certificate.6.,295,"The product does not validate, or incorrectly validates, a certificate.",0.9976333379745483
33884-i01.docx.txt,"The AEF especially ensures that the scope of API calls is restricted to resources owned the UE, whose identity is included in the token claims.",708,"The product assigns an owner to a resource, but the owner is outside of the intended control sphere.",0.9976053237915039
33884-i01.docx.txt,API calls with a wider scope are rejected by the AEF.,120,"The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",0.9976667165756226
33884-i01.docx.txt,In case of successful validation the AEF is executing the request by involving other NFs (not shown in the signalling diagram)9.,476,"A NULL pointer dereference occurs when the application dereferences a pointer that it expects to be valid, but is NULL, typically causing a crash or exit.",0.9976590871810913
33884-i01.docx.txt,"Authentication of the UE is executed using http authentication mechanism, i.e. as part of the http token request.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976608753204346
33884-i01.docx.txt,In this solution the 5G system only authenticates and authorizes the UE.,1333,"The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles.",0.9976516366004944
33884-i01.docx.txt,The 5G system does not authenticate or authorize the (invisible) third party application or a user.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976522326469421
33884-i01.docx.txt,"That is, the solution assumes that the UE is the resource owner or requesting party.",639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976447224617004
33884-i01.docx.txt,The UE is provisioned with a CAPIF Core Function (CCF) information such as CCF address/ID (e.g. after a successful primary authentication in any protected message).,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976509213447571
33884-i01.docx.txt,"The CCF can send a key request to the Core NF/AF which can include UE ID, and Kccf ID3.",918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9976387023925781
33884-i01.docx.txt,"The CCF stores the CCF key, Kccf ID and UE ID.",639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976454377174377
33884-i01.docx.txt,The CCF generates an API invoker's profile and onboard secret as specified in.,312,The product stores sensitive information in cleartext within a resource that might be accessible to another control sphere.,0.99764084815979
33884-i01.docx.txt,The AEF Key can be used by the API Invoker to authenticate and establish secure session with the AEF as inClause 6.5.2.3 .,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976398944854736
33884-i01.docx.txt,Target AEF ID).API Invoker can perform CAPIF-1 authentication anytime with CCF based on.7.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976615905761719
33884-i01.docx.txt,It is assumed that the network manages such authorization information in any storage function outside the scope of this solution.,256,Storing a password in plaintext may result in a system compromise.,0.997657299041748
33884-i01.docx.txt,The CCF generates and sends an Oauth access token (based on OAuth 2.0) to be used as AEF Access token.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9975650310516357
33884-i01.docx.txt,"The API Invoker can send Authentication Initiation Request to the AEF, which includes the CCF assigned API invoker ID, and UE ID.12.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976609945297241
33884-i01.docx.txt,"NOTE 3: According to , API provider domain provides Onboarding enrolment information to the API invoker as a prerequisite to the Onboarding procedure.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9975544810295105
33884-i01.docx.txt,Figure 6.5.2-1 shows the resource authorization procedure to allow access to resources.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976365566253662
33884-i01.docx.txt,"The UE initiates a resource owner registration request with CAPIF-UE ID, GPSI and a freshness parameter to the CAPIF function.",425,"The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",0.9969192743301392
33884-i01.docx.txt,The CAPIF function verifies if the received CAPIF-UE ID matches with the resource owner authorization data received in step 4a.,78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",0.9976404905319214
33884-i01.docx.txt,"If the verification is successful, the CAPIF function considers the resource owner registration as successful and it assigns a Resource Owner Identity.",708,"The product assigns an owner to a resource, but the owner is outside of the intended control sphere.",0.9976365566253662
33884-i01.docx.txt,The CAPIF Function can send a resource owner registration response with nonce.,94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9972678422927856
33884-i01.docx.txt,The CAPIF Function then sends a resource owner ID and lifetime (for the resource owner registration) following a successful resource owner registration.,772,"The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed.",0.9976218342781067
33884-i01.docx.txt,The solution requires access to 5G key hierarchy and will only work when the UE is authenticated to 5G network.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9924582839012146
33884-i01.docx.txt,How the MNO authenticates the resource owner and learns the authorization information is out of scope of this solution.,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",0.9974187612533569
33884-i01.docx.txt,This solution works as follow for the use case #1 defined in Annex A of TR 23.700-95 .,378,"Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.",0.9976240992546082
33884-i01.docx.txt,The CCF issues an access token that includes an indication for the resource owner authorization.,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.997634768486023
33884-i01.docx.txt,The API invoker sends the token to the API Exposing Function.,120,"The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",0.9976341724395752
33884-i01.docx.txt,This solution applies to the specific case where the application is accessing to the resources of the UE on which the application is running.,73,The product allows user input to control or influence paths or file names that are used in filesystem operations.,0.9976338148117065
33884-i01.docx.txt,The case of accessing resource of other UEs by the UE is not covered in this solution.,312,The product stores sensitive information in cleartext within a resource that might be accessible to another control sphere.,0.997642457485199
33884-i01.docx.txt,"The following procedure, depicted in Figure 6.6.2-2, shows how revocation of authorization by the resource owner can be handled.",552,"The product makes files or directories accessible to unauthorized actors, even though they should not be.",0.9976446032524109
33884-i01.docx.txt,"The AEF verifies the access token, checks the resource owner authorization.",613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976601600646973
33884-i01.docx.txt,This solution is very similar to the existing mechanism for the AF originated API invocation case where the AF is outside of the UE.,94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9975710511207581
33884-i01.docx.txt,Resource owner can authorize API invoker for resources via the UE.,641,"The product constructs the name of a file or other resource using input from an upstream component, but it does not restrict or incorrectly restricts the resulting name.",0.9976539015769958
33884-i01.docx.txt,"For the case that API invoker is the UE, the mutual authentication can be realized based on certificates.",295,"The product does not validate, or incorrectly validates, a certificate.",0.9976615905761719
33884-i01.docx.txt,A secure connection between API invoker and resource owner is established after the mutual authentication.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.997660756111145
33884-i01.docx.txt,The API invoker sends authorization request to the UE controlled by the resource owner.,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",0.9976377487182617
33884-i01.docx.txt,The service identifier/service operation identifier indicates the service/service operation that can be performed on the target resource.,89,"The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.",0.9976600408554077
33884-i01.docx.txt,"Therefore, the CAPIF core function/authorization function can generate the access token containing4.",639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976422190666199
33884-i01.docx.txt,The resource owner And the resource owner sends the authorization request and grant information to the CAPIF core function/authorization function to request the authorization code.,708,"The product assigns an owner to a resource, but the owner is outside of the intended control sphere.",0.9976323843002319
33884-i01.docx.txt,CAPIF core function/authorization function can authorize the authorization request for the resource based on the pre-generated profile.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.99764484167099
33884-i01.docx.txt,", the CAPIF core function/authorization function generates authorization code for the API.",22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",0.9976365566253662
33884-i01.docx.txt,"Then CAPIF core function can authenticate API invoker using GBA-based authentication mechanism, AKMA-based authentication mechanism or certificate-based authentication mechanism.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976598024368286
33884-i01.docx.txt,"And CAPIF core function For the case of authorization function, API invoker can authenticate authorization function via certificate.",295,"The product does not validate, or incorrectly validates, a certificate.",0.9976601600646973
33884-i01.docx.txt,A secure connection between API invoker and CAPIF core function/authorization function is established after the mutual authentication.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976612329483032
33884-i01.docx.txt,The CAPIF core function/authorization function sends the refresh token/access token to the API invoker.,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976596832275391
33884-i01.docx.txt,The API invoker can send the refresh token to CAPIF core function/authorization function to obtain access token.,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.99765944480896
33884-i01.docx.txt,A secure connection between API invoker and API Exposing function is established after the mutual authentication.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976608753204346
33884-i01.docx.txt,The API invoker sends service API invocation request to the AEF.,918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9976412057876587
33884-i01.docx.txt,Benefits:Impacts:6.10.1 Introduction This solution addresses the key issue key issue #1 and #2 in terms of API invoker UE authorization.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.997647225856781
33884-i01.docx.txt,"The shared secrets among UE and authorization function can be shared keys related to AKMA method, GBA method, and CAPIF onboarding procedure.1.",319,The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.,0.9976638555526733
33884-i01.docx.txt,The API invoker and authorization function/CAPIF core function do the mutual authentication.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976612329483032
33884-i01.docx.txt,"For the case of CAPIF core function, the API invoker can authenticate CAPIF core function via a certificate.",295,"The product does not validate, or incorrectly validates, a certificate.",0.9976611137390137
33884-i01.docx.txt,"Then the CAPIF core function can authenticate the API invoker using GBA-based authentication mechanism, AKMA-based authentication mechanism or certificate-based authentication mechanism.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976599216461182
33884-i01.docx.txt,"And the CAPIF core function For the case of authorization function, the API invoker can authenticate the authorization function via a certificate.",295,"The product does not validate, or incorrectly validates, a certificate.",0.9976338148117065
33884-i01.docx.txt,Authorization function can authenticate the API invoker UE based on its credential (e.g. KAF).,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976465106010437
33884-i01.docx.txt,API invoker and authorization function A secure connection between the API invoker and authorization function/CAPIF core function is established after the mutual authentication.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976600408554077
33884-i01.docx.txt,"The token Details on token, refresh token, and access token are given in RFC .5.",613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976602792739868
33884-i01.docx.txt,The API invoker sends a service API request to the API exposing function along with the access token.,378,"Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.",0.9976276755332947
33884-i01.docx.txt,API exposing function checks whether the API Invoker is authorized to invoke the service API based on the selected authorization method in step 2.,79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.9975671768188477
33884-i01.docx.txt,"The response includes revocation time and the TokenSNAAPPY with MAC which the Authorization Function generates using the TokenSNAAPPY, revocation time, and KSNAAPPY; and11.",613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976598024368286
33884-i01.docx.txt,"The claims of the TokenAuz include service API name, S-KID (SNAAPPY Key Identifier), API Invoker Information, ""Authorized"", generated time, and validity time.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9976078271865845
33884-i01.docx.txt,"TokenAuz contains the claims (TokenAuz, claim) and the verification information (TokenAuz, verify).",347,"The product does not verify, or incorrectly verifies, the cryptographic signature for data.",0.9973405003547668
33884-i01.docx.txt,"TokenAuz, verify is generated as detailed in clause 6.12.2.5 by using the claims and the key KAuz.4.",346,The product does not properly verify that the source of data or communication is valid.,0.9976237416267395
33884-i01.docx.txt,"Upon receiving the response, the API Invoker stores the TokenAuz with UE ID (e.g. application layer ID or GPSI or SUPI).",204,The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere.,0.9976493716239929
33884-i01.docx.txt,"API exposing function requests token verification to Authorization Function, via CAPIF-9 interface.8.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.997660756111145
33884-i01.docx.txt,Authorization Function responds with the verification result and UE ID (SUPI or GPSI).10.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976612329483032
33884-i01.docx.txt,"UE and Authorization function perform mutual authentication based on TLS-PSK as specified in clause 6.5.2.1 in , where PSK can be derived from KAuz.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976592063903809
33884-i01.docx.txt,The TokenRev is transmitted to Authorization Function via CAPIF-8 interface with revocation request message.14.,425,"The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",0.9976323843002319
33884-i01.docx.txt,"This solution uses similar mechanism as users of mobile phone giving a permission to application for access to resources such as phonebook, microphone, camera, etc.",276,"During installation, installed file permissions are set to allow anyone to modify those files.",0.9976625442504883
33884-i01.docx.txt,The solution requires the UE to be authenticated to a 5G core.,120,"The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",0.9976540207862854
33884-i01.docx.txt,Authorization needs to be provided in advance of calling the API.It is assumed that the API invoker is an UE/AF in SNA scenarios.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976614713668823
33884-i01.docx.txt,"The CCF issues a token with a short expiry time when receiving the requirement for revocation, e.g. 1 hour.",770,"The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",0.9976410865783691
33884-i01.docx.txt,"The claim in the token includes resource owner identity, thus there is no need for additional UE authentication in API invocation.",708,"The product assigns an owner to a resource, but the owner is outside of the intended control sphere.",0.9975804090499878
33884-i01.docx.txt,"Based on the operator's policy, mutual authentication between resource owner and CCF/AUF can be performed.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976625442504883
