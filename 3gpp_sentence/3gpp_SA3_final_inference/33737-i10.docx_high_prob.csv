File Name,Sentence,Mapped CWE-ID,CWE Description,Positive Probability
33737-i10.docx.txt,"The present document studies key issues and potential solutions to support roaming aspects and the Authentication Proxy in AKMA, which is specified in.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976613521575928
33737-i10.docx.txt,"The AUSF sends the Naanf_AKMA_AnchorKey_Register Request with SUPI, A-KID, KAKMA, and Registered SN ID to the home AAnF.",918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9913040399551392
33737-i10.docx.txt,The AKMA context is updated with this received Registered SN ID.5a.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.997649610042572
33737-i10.docx.txt,The UE requests an application session establishment request with A-KID towards the AF.,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.99764484167099
33737-i10.docx.txt,IntroductionThis solution provides a method that when both UE and the AF in the same visited network.,209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9976359605789185
33737-i10.docx.txt,"When the AF is inside 5GC, it can communicate with the UE's AAnF in HPLMN directly.",611,"The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",0.9976606369018555
33737-i10.docx.txt,"Step 6, the UDM sends the Nudm_Get_Roaming_NFid Response message to the AF with the VPLMN NF id(s).",918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9976480603218079
33737-i10.docx.txt,"If not, the VPLMN NF ignores the Push application Key Request message.",918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9976402521133423
33737-i10.docx.txt,Figure 6.4.1-1 shows the SBA architecture that UE is roaming in a VPLMN and accesses the application deployed in the VPLMN.,94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9976547956466675
33737-i10.docx.txt,"In this scenario, the AF in the service network can sense the AKMA service used by the UE.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9976735711097717
33737-i10.docx.txt,The AUSF requests authentication information to the UDM to acquire subscription information and authentication method in primary authentication procedure.3.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976602792739868
33737-i10.docx.txt,"If the AUSF receives the AKMA indication from the UDM, the AUSF stores SN-name, KAUSF and generate AKMA Anchor Key (KAKMA) and the A-KID.",73,The product allows user input to control or influence paths or file names that are used in filesystem operations.,0.9973732233047485
33737-i10.docx.txt,The UE generates the KAKMA and the A-KID if the primary authentication procedure is completed.5.,305,"The authentication algorithm is sound, but the implemented mechanism can be bypassed as the result of a separate weakness that is primary to the authentication error.",0.9976415634155273
33737-i10.docx.txt,"To select the AAnF in VPLMN to register KAKMA and A-KID, local configuration or NRF can be utilized.",78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",0.9976339340209961
33737-i10.docx.txt,"If the AF decides to support the UE from other serving network, the AF requests application key to the AAnF in VPLMN.",918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9971291422843933
33737-i10.docx.txt,"To selects the AAnF in VPLMN for the AF to provide the KAF, local configuration or NRF can be utilized.",78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",0.9976379871368408
33737-i10.docx.txt,"When the UE initiates communication with the AF in HPLMN, it includes the derived A-KID in the Application Session Establishment Request message.4.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.997638463973999
33737-i10.docx.txt,"KAKMA in HPLMN is shared to VPLMN, and same KAKMA will be AKMA anchor key in HPLMN and VPLMN.",78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",0.9976428151130676
33737-i10.docx.txt,"In step 9, the HAAnF detects based on the SN name that the UE is roaming and if the VPLMN has AKMA LI enhancements.",79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.9976592063903809
33737-i10.docx.txt,"If the AF further derives a session key from KAF, then this is also provided to the HAAnF.",613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976703524589539
33737-i10.docx.txt,"The HAAnF needs to be enhanced with SLAs, operator policies or corresponding contact NF (NEF or VAAnF) in the VPLMNs.",79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.9975722432136536
33737-i10.docx.txt,"It helps to reduce the consumption of authentication vectors and/or to minimize SQN synchronization failures, and relieves the AS of security tasks.",22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",0.9976601600646973
33737-i10.docx.txt,It The AP helps the ASs behind the AP to execute AKMA procedures to save the consumption of signalling resources and AAnF computing resources.,770,"The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",0.9976588487625122
33737-i10.docx.txt,"When an HTTPS request is destined towards an application server (AS) behind an AP, the AP terminates the TLS tunnel and performs UE authentication.",306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9976625442504883
33737-i10.docx.txt,The AP proxies the HTTP requests received from UE to one or many application servers.,444,"The product acts as an intermediary HTTP agent (such as a proxy or firewall) in the data flow between two entities such as a client and server, but it does not interpret malformed HTTP requests or responses in ways that are consistent with how the messages will be processed by those entities that are at the ultimate destination.",0.9976416826248169
33737-i10.docx.txt,The AAnF obtains the VPLMN NF (e.g. AMF) id that can store the key from the UDM based on the UE ID.,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.9976410865783691
33737-i10.docx.txt,"Step 5, the UDM sends the Nudm_Get_Roaming_NFid Response message to the AAnF with the VPLMN NF id(s).",204,The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere.,0.9976352453231812
33737-i10.docx.txt,"If not, the VPLMN NF ignores the Push application Key Request message.",918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9976402521133423
33737-i10.docx.txt,The proposed solution supports AKMA roaming by using K_SEAF to derive K_AKMA when the UE connects through the VPLMN.,346,The product does not properly verify that the source of data or communication is valid.,0.9968133568763733
33737-i10.docx.txt,"Similarly, the HPLMN can also generate the same AKMA keys derived from K_SEAF since the AUSF has K_AUSF.",94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9975355863571167
33737-i10.docx.txt,This approach removes the need of interacting between VPLMN and HPLMN to retrieve those keys.,1021,"The web application does not restrict or incorrectly restricts frame objects or UI layers that belong to another application or domain, which can lead to user confusion about which interface the user is interacting with.",0.9976442456245422
33737-i10.docx.txt,This approach facilitates LI during roaming since AKMA keys are directly available in the VPLMN.a) R17 UEs cannot access AKMA services when roaming.,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.,0.9974942207336426
33737-i10.docx.txt,Then KAUSF is shared between UE and AUSF in Home network.,552,"The product makes files or directories accessible to unauthorized actors, even though they should not be.",0.9976212382316589
33737-i10.docx.txt,Step 4: UE send Application session establishment request (A-KID) to AF.,918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.9975627660751343
33737-i10.docx.txt,The selection of the AAnF is described in clause 6.7 of.10.,120,"The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",0.9976474642753601
33737-i10.docx.txt,"When the UE initiates communication with the AF in VPLMN, it includes the derived A-KID in the Application Session Establishment Request message.3.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9976099729537964
33737-i10.docx.txt,The AF in HPLMN requests application key to the AAnF in HPLMN.,476,"A NULL pointer dereference occurs when the application dereferences a pointer that it expects to be valid, but is NULL, typically causing a crash or exit.",0.9976590871810913
33737-i10.docx.txt,AUSF can decide this based on indication from the UDM in Step (1) and/or local policy.,378,"Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.",0.9920753240585327
33737-i10.docx.txt,"Based on the received information, if vAAnF receives KAF and Key lifetime, it provides the same to AF.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9975770115852356
33737-i10.docx.txt,NOTE 2: How the solution is aligned with the architectural assumption in clause 4 is not addressed in the present document.,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",0.9976240992546082
33737-i10.docx.txt,Impacts to UE: - UE needs to send the SN ID in the session establishment request to the AF.,613,"According to WASC, Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.",0.9976696372032166
33737-i10.docx.txt,The solution also ensures that the AKMA Application Key KAF provided by the HPLMN to VPLMN is correct.,78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",0.9976373910903931
33737-i10.docx.txt,Solution detailsPre-requisite: there is establishment of the key KAKMA between the UE and hAAnF.,79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.9976499676704407
33737-i10.docx.txt,"And, during the establishment of the AKMA key (KAKMA), the AUSF also provides the SN name to the AAnF in the HPLMN (hAAnF).",641,"The product constructs the name of a file or other resource using input from an upstream component, but it does not restrict or incorrectly restricts the resulting name.",0.9976308345794678
33737-i10.docx.txt,"This message contains the current GUTI value encrypted by the UE with KAF, and associated A-KID and AF-ID.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.997635006904602
33737-i10.docx.txt,The UE can use KAF if the KAF check was successful.,79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.9976499676704407
33737-i10.docx.txt,This solution also covers the scenario where AF is an external AF in Data Network.,552,"The product makes files or directories accessible to unauthorized actors, even though they should not be.",0.9905217885971069
33737-i10.docx.txt,"NOTE 2: According to, 4.2.8.2.2, the UE can be registered in two VPLMNs.",434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.,0.9976517558097839
33737-i10.docx.txt,the AMF obtains the address of ASNF via the NRF or local configuration.,552,"The product makes files or directories accessible to unauthorized actors, even though they should not be.",0.9976390600204468
33737-i10.docx.txt,"The message contains the UE SUPI, serving PLMN ID, and ASNF address.",639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.997641921043396
33737-i10.docx.txt,The UE registration information is updated and stored in the UDM.4b.,552,"The product makes files or directories accessible to unauthorized actors, even though they should not be.",0.9976346492767334
33737-i10.docx.txt,"The AF requests the AF key (KAF) from the AAnF, possibly via NEF.",378,"Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.",0.9976478219032288
33737-i10.docx.txt,The AAnF generates AF key (KAF) and returns the key to the AF as specified in.,798,"The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data.",0.99764484167099
33737-i10.docx.txt,The AAnF now have AKMA related key material and parameters KAF and the information used for key derivation thereof.,94,"The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",0.9976274371147156
33737-i10.docx.txt,"The message contains for example the UE ID, keys and parameters used to derive AKMA application session keys.8.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9976558685302734
33737-i10.docx.txt,"The message contains UE ID (e.g., SUPI), and cryptographic information such as selected encryption algorithms, cipher suites, input for ciphering: key(s), nonce(s), counter(s) etc.",209,"The product generates an error message that includes sensitive information about its environment, users, or associated data.",0.9976149797439575
33737-i10.docx.txt,Now the ASNF(s) has/have the AKMA cryptographic information for the UE and perform(s) necessary regulatory actions accordingly.,347,"The product does not verify, or incorrectly verifies, the cryptographic signature for data.",0.9976406097412109
